var _Mathround=Math.round,_NumberMAX_VALUE=Number.MAX_VALUE,_Mathceil=Math.ceil,_Mathlog=Math.log,_Mathmax=Math.max,_Mathsqrt=Math.sqrt,_Mathabs=Math.abs,_Mathfloor=Math.floor,_Mathpow=Math.pow,_StringfromCharCode=String.fromCharCode,_Mathmin=Math.min,_NumberisInteger=Number.isInteger;(function(u,C){'object'==typeof exports&&'object'==typeof module?module.exports=C():'function'==typeof define&&define.amd?define([],C):'object'==typeof exports?exports.chemEquilibrium=C():u.chemEquilibrium=C()})(this,function(){return function(o){function u(S){if(C[S])return C[S].exports;var O=C[S]={i:S,l:!1,exports:{}};return o[S].call(O.exports,O,O.exports,u),O.l=!0,O.exports}var C={};return u.m=o,u.c=C,u.i=function(S){return S},u.d=function(S,O,_){u.o(S,O)||Object.defineProperty(S,O,{configurable:!1,enumerable:!0,get:_})},u.n=function(S){var O=S&&S.__esModule?function(){return S['default']}:function(){return S};return u.d(O,'a',O),O},u.o=function(S,O){return Object.prototype.hasOwnProperty.call(S,O)},u.p='',u(u.s=20)}([function(o,u,C){'use strict';C(37);var S=C(9),O=C(2);class _ extends S(Array){constructor(A,K){var I;if(1===arguments.length&&'number'==typeof A)return Array(A);if(_.isMatrix(A))return A.clone();if(_NumberisInteger(A)&&0<A){if(super(A),_NumberisInteger(K)&&0<K)for(I=0;I<A;I++)this[I]=Array(K);else throw new TypeError('nColumns must be a positive integer');}else if(Array.isArray(A)){const M=A;if(A=M.length,K=M[0].length,'number'!=typeof K||0===K)throw new TypeError('Data must be a 2D array with at least one element');for(super(A),I=0;I<A;I++){if(M[I].length!==K)throw new RangeError('Inconsistent array dimensions');this[I]=[].concat(M[I])}}else throw new TypeError('First argument must be a positive number or an array');return this.rows=A,this.columns=K,this}set(A,K,I){return this[A][K]=I,this}get(A,K){return this[A][K]}clone(){for(var A=new this.constructor[Symbol.species](this.rows,this.columns),K=0;K<this.rows;K++)for(var I=0;I<this.columns;I++)A.set(K,I,this.get(K,I));return A}removeRow(A){if(O.checkRowIndex(this,A),1===this.rows)throw new RangeError('A matrix cannot have less than one row');return this.splice(A,1),this.rows-=1,this}addRow(A,K){return void 0===K&&(K=A,A=this.rows),O.checkRowIndex(this,A,!0),K=O.checkRowVector(this,K,!0),this.splice(A,0,K),this.rows+=1,this}removeColumn(A){if(O.checkColumnIndex(this,A),1===this.columns)throw new RangeError('A matrix cannot have less than one column');for(var K=0;K<this.rows;K++)this[K].splice(A,1);return this.columns-=1,this}addColumn(A,K){'undefined'==typeof K&&(K=A,A=this.columns),O.checkColumnIndex(this,A,!0),K=O.checkColumnVector(this,K);for(var I=0;I<this.rows;I++)this[I].splice(A,0,K[I]);return this.columns+=1,this}}u.Matrix=_,_.abstractMatrix=S},function(o,u,C){'use strict';var S=C(9),O=C(0);class _ extends S(){constructor(A,K,I){super(),this.matrix=A,this.rows=K,this.columns=I}static get[Symbol.species](){return O.Matrix}}o.exports=_},function(o,u,C){'use strict';var S=C(0);u.checkRowIndex=function(_,A,K){var I=K?_.rows:_.rows-1;if(0>A||A>I)throw new RangeError('Row index out of range')},u.checkColumnIndex=function(_,A,K){var I=K?_.columns:_.columns-1;if(0>A||A>I)throw new RangeError('Column index out of range')},u.checkRowVector=function(_,A){if(A.to1DArray&&(A=A.to1DArray()),A.length!==_.columns)throw new RangeError('vector size must be the same as the number of columns');return A},u.checkColumnVector=function(_,A){if(A.to1DArray&&(A=A.to1DArray()),A.length!==_.rows)throw new RangeError('vector size must be the same as the number of rows');return A},u.checkIndices=function(_,A,K){var I=A.some((R)=>{return 0>R||R>=_.rows}),M=K.some((R)=>{return 0>R||R>=_.columns});if(I||M)throw new RangeError('Indices are out of range');if('object'!=typeof A||'object'!=typeof K)throw new TypeError('Unexpected type for row/column indices');return Array.isArray(A)||(A=Array.from(A)),Array.isArray(K)||(A=Array.from(K)),{row:A,column:K}},u.checkRange=function(_,A,K,I,M){if(5!==arguments.length)throw new TypeError('Invalid argument type');var R=Array.from(arguments).slice(1).some(function(E){return'number'!=typeof E});if(R)throw new TypeError('Invalid argument type');if(A>K||I>M||0>A||A>=_.rows||0>K||K>=_.rows||0>I||I>=_.columns||0>M||M>=_.columns)throw new RangeError('Submatrix indices are out of range')},u.getRange=function(_,A){for(var K=Array(A-_+1),I=0;I<K.length;I++)K[I]=_+I;return K},u.sumByRow=function(_){for(var A=S.Matrix.zeros(_.rows,1),K=0;K<_.rows;++K)for(var I=0;I<_.columns;++I)A.set(K,0,A.get(K,0)+_.get(K,I));return A},u.sumByColumn=function(_){for(var A=S.Matrix.zeros(1,_.columns),K=0;K<_.rows;++K)for(var I=0;I<_.columns;++I)A.set(0,I,A.get(0,I)+_.get(K,I));return A},u.sumAll=function(_){for(var A=0,K=0;K<_.rows;K++)for(var I=0;I<_.columns;I++)A+=_.get(K,I);return A}},function(o,u,C){'use strict';(function(S){function _(){return K.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function A(Pe,qe){if(_()<qe)throw new RangeError('Invalid typed array length');return K.TYPED_ARRAY_SUPPORT?(Pe=new Uint8Array(qe),Pe.__proto__=K.prototype):(null===Pe&&(Pe=new K(qe)),Pe.length=qe),Pe}function K(Pe,qe,Ne){if(!K.TYPED_ARRAY_SUPPORT&&!(this instanceof K))return new K(Pe,qe,Ne);if('number'==typeof Pe){if('string'==typeof qe)throw new Error('If encoding is specified then the first argument must be a string');return E(this,Pe)}return I(this,Pe,qe,Ne)}function I(Pe,qe,Ne,De){if('number'==typeof qe)throw new TypeError('"value" argument must not be a number');return'undefined'!=typeof ArrayBuffer&&qe instanceof ArrayBuffer?T(Pe,qe,Ne,De):'string'==typeof qe?P(Pe,qe,Ne):F(Pe,qe)}function M(Pe){if('number'!=typeof Pe)throw new TypeError('"size" argument must be a number');else if(0>Pe)throw new RangeError('"size" argument must not be negative')}function R(Pe,qe,Ne,De){return M(qe),0>=qe?A(Pe,qe):void 0===Ne?A(Pe,qe):'string'==typeof De?A(Pe,qe).fill(Ne,De):A(Pe,qe).fill(Ne)}function E(Pe,qe){if(M(qe),Pe=A(Pe,0>qe?0:0|Z(qe)),!K.TYPED_ARRAY_SUPPORT)for(var Ne=0;Ne<qe;++Ne)Pe[Ne]=0;return Pe}function P(Pe,qe,Ne){if(('string'!=typeof Ne||''===Ne)&&(Ne='utf8'),!K.isEncoding(Ne))throw new TypeError('"encoding" must be a valid string encoding');var De=0|J(qe,Ne);Pe=A(Pe,De);var Te=Pe.write(qe,Ne);return Te!==De&&(Pe=Pe.slice(0,Te)),Pe}function D(Pe,qe){var Ne=0>qe.length?0:0|Z(qe.length);Pe=A(Pe,Ne);for(var De=0;De<Ne;De+=1)Pe[De]=255&qe[De];return Pe}function T(Pe,qe,Ne,De){if(qe.byteLength,0>Ne||qe.byteLength<Ne)throw new RangeError('\'offset\' is out of bounds');if(qe.byteLength<Ne+(De||0))throw new RangeError('\'length\' is out of bounds');return qe=void 0===Ne&&void 0===De?new Uint8Array(qe):void 0===De?new Uint8Array(qe,Ne):new Uint8Array(qe,Ne,De),K.TYPED_ARRAY_SUPPORT?(Pe=qe,Pe.__proto__=K.prototype):Pe=D(Pe,qe),Pe}function F(Pe,qe){if(K.isBuffer(qe)){var Ne=0|Z(qe.length);return(Pe=A(Pe,Ne),0===Pe.length)?Pe:(qe.copy(Pe,0,0,Ne),Pe)}if(qe){if('undefined'!=typeof ArrayBuffer&&qe.buffer instanceof ArrayBuffer||'length'in qe)return'number'!=typeof qe.length||ve(qe.length)?A(Pe,0):D(Pe,qe);if('Buffer'===qe.type&&Be(qe.data))return D(Pe,qe.data)}throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')}function Z(Pe){if(Pe>=_())throw new RangeError('Attempt to allocate Buffer larger than maximum size: 0x'+_().toString(16)+' bytes');return 0|Pe}function J(Pe,qe){if(K.isBuffer(Pe))return Pe.length;if('undefined'!=typeof ArrayBuffer&&'function'==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(Pe)||Pe instanceof ArrayBuffer))return Pe.byteLength;'string'!=typeof Pe&&(Pe=''+Pe);var Ne=Pe.length;if(0===Ne)return 0;for(var De=!1;;)switch(qe){case'ascii':case'latin1':case'binary':return Ne;case'utf8':case'utf-8':case void 0:return Se(Pe).length;case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return 2*Ne;case'hex':return Ne>>>1;case'base64':return Ae(Pe).length;default:if(De)return Se(Pe).length;qe=(''+qe).toLowerCase(),De=!0;}}function $(Pe,qe,Ne){var De=!1;if((void 0===qe||0>qe)&&(qe=0),qe>this.length)return'';if((void 0===Ne||Ne>this.length)&&(Ne=this.length),0>=Ne)return'';if(Ne>>>=0,qe>>>=0,Ne<=qe)return'';for(Pe||(Pe='utf8');;)switch(Pe){case'hex':return de(this,qe,Ne);case'utf8':case'utf-8':return le(this,qe,Ne);case'ascii':return ce(this,qe,Ne);case'latin1':case'binary':return me(this,qe,Ne);case'base64':return ae(this,qe,Ne);case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return ue(this,qe,Ne);default:if(De)throw new TypeError('Unknown encoding: '+Pe);Pe=(Pe+'').toLowerCase(),De=!0;}}function W(Pe,qe,Ne){var De=Pe[qe];Pe[qe]=Pe[Ne],Pe[Ne]=De}function G(Pe,qe,Ne,De,Te){if(0===Pe.length)return-1;if('string'==typeof Ne?(De=Ne,Ne=0):2147483647<Ne?Ne=2147483647:-2147483648>Ne&&(Ne=-2147483648),Ne=+Ne,isNaN(Ne)&&(Ne=Te?0:Pe.length-1),0>Ne&&(Ne=Pe.length+Ne),Ne>=Pe.length){if(Te)return-1;Ne=Pe.length-1}else if(0>Ne)if(Te)Ne=0;else return-1;if('string'==typeof qe&&(qe=K.from(qe,De)),K.isBuffer(qe))return 0===qe.length?-1:ee(Pe,qe,Ne,De,Te);if('number'==typeof qe)return qe&=255,K.TYPED_ARRAY_SUPPORT&&'function'==typeof Uint8Array.prototype.indexOf?Te?Uint8Array.prototype.indexOf.call(Pe,qe,Ne):Uint8Array.prototype.lastIndexOf.call(Pe,qe,Ne):ee(Pe,[qe],Ne,De,Te);throw new TypeError('val must be string, number or Buffer')}function ee(Pe,qe,Ne,De,Te){function Le(Xe,Je){return 1==Ue?Xe[Je]:Xe.readUInt16BE(Je*Ue)}var Ue=1,Ve=Pe.length,Fe=qe.length;if(void 0!==De&&(De=(De+'').toLowerCase(),'ucs2'===De||'ucs-2'===De||'utf16le'===De||'utf-16le'===De)){if(2>Pe.length||2>qe.length)return-1;Ue=2,Ve/=2,Fe/=2,Ne/=2}var ze;if(Te){var Ye=-1;for(ze=Ne;ze<Ve;ze++)if(Le(Pe,ze)!==Le(qe,-1==Ye?0:ze-Ye))-1!=Ye&&(ze-=ze-Ye),Ye=-1;else if(-1==Ye&&(Ye=ze),ze-Ye+1===Fe)return Ye*Ue}else for(Ne+Fe>Ve&&(Ne=Ve-Fe),ze=Ne;0<=ze;ze--){for(var Ze=!0,Qe=0;Qe<Fe;Qe++)if(Le(Pe,ze+Qe)!==Le(qe,Qe)){Ze=!1;break}if(Ze)return ze}return-1}function te(Pe,qe,Ne,De){Ne=+Ne||0;var Te=Pe.length-Ne;De?(De=+De,De>Te&&(De=Te)):De=Te;var Le=qe.length;if(0!=Le%2)throw new TypeError('Invalid hex string');De>Le/2&&(De=Le/2);for(var Ve,Ue=0;Ue<De;++Ue){if(Ve=parseInt(qe.substr(2*Ue,2),16),isNaN(Ve))return Ue;Pe[Ne+Ue]=Ve}return Ue}function oe(Pe,qe,Ne,De){return Ke(Se(qe,Pe.length-Ne),Pe,Ne,De)}function ne(Pe,qe,Ne,De){return Ke(He(qe),Pe,Ne,De)}function ie(Pe,qe,Ne,De){return ne(Pe,qe,Ne,De)}function se(Pe,qe,Ne,De){return Ke(Ae(qe),Pe,Ne,De)}function re(Pe,qe,Ne,De){return Ke(Oe(qe,Pe.length-Ne),Pe,Ne,De)}function ae(Pe,qe,Ne){return 0===qe&&Ne===Pe.length?Ie.fromByteArray(Pe):Ie.fromByteArray(Pe.slice(qe,Ne))}function le(Pe,qe,Ne){Ne=_Mathmin(Pe.length,Ne);for(var De=[],Te=qe;Te<Ne;){var Le=Pe[Te],Ue=null,Ve=239<Le?4:223<Le?3:191<Le?2:1;if(Te+Ve<=Ne){var Fe,ze,Ye,Ze;1==Ve?128>Le&&(Ue=Le):2==Ve?(Fe=Pe[Te+1],128==(192&Fe)&&(Ze=(31&Le)<<6|63&Fe,127<Ze&&(Ue=Ze))):3==Ve?(Fe=Pe[Te+1],ze=Pe[Te+2],128==(192&Fe)&&128==(192&ze)&&(Ze=(15&Le)<<12|(63&Fe)<<6|63&ze,2047<Ze&&(55296>Ze||57343<Ze)&&(Ue=Ze))):4==Ve?(Fe=Pe[Te+1],ze=Pe[Te+2],Ye=Pe[Te+3],128==(192&Fe)&&128==(192&ze)&&128==(192&Ye)&&(Ze=(15&Le)<<18|(63&Fe)<<12|(63&ze)<<6|63&Ye,65535<Ze&&1114112>Ze&&(Ue=Ze))):void 0}null===Ue?(Ue=65533,Ve=1):65535<Ue&&(Ue-=65536,De.push(55296|1023&Ue>>>10),Ue=56320|1023&Ue),De.push(Ue),Te+=Ve}return pe(De)}function pe(Pe){var qe=Pe.length;if(qe<=Re)return _StringfromCharCode.apply(String,Pe);for(var Ne='',De=0;De<qe;)Ne+=_StringfromCharCode.apply(String,Pe.slice(De,De+=Re));return Ne}function ce(Pe,qe,Ne){var De='';Ne=_Mathmin(Pe.length,Ne);for(var Te=qe;Te<Ne;++Te)De+=_StringfromCharCode(127&Pe[Te]);return De}function me(Pe,qe,Ne){var De='';Ne=_Mathmin(Pe.length,Ne);for(var Te=qe;Te<Ne;++Te)De+=_StringfromCharCode(Pe[Te]);return De}function de(Pe,qe,Ne){var De=Pe.length;(!qe||0>qe)&&(qe=0),(!Ne||0>Ne||Ne>De)&&(Ne=De);for(var Te='',Le=qe;Le<Ne;++Le)Te+=Ce(Pe[Le]);return Te}function ue(Pe,qe,Ne){for(var De=Pe.slice(qe,Ne),Te='',Le=0;Le<De.length;Le+=2)Te+=_StringfromCharCode(De[Le]+256*De[Le+1]);return Te}function ge(Pe,qe,Ne){if(0!=Pe%1||0>Pe)throw new RangeError('offset is not uint');if(Pe+qe>Ne)throw new RangeError('Trying to access beyond buffer length')}function fe(Pe,qe,Ne,De,Te,Le){if(!K.isBuffer(Pe))throw new TypeError('"buffer" argument must be a Buffer instance');if(qe>Te||qe<Le)throw new RangeError('"value" argument is out of bounds');if(Ne+De>Pe.length)throw new RangeError('Index out of range')}function he(Pe,qe,Ne,De){0>qe&&(qe=65535+qe+1);for(var Te=0,Le=_Mathmin(Pe.length-Ne,2);Te<Le;++Te)Pe[Ne+Te]=(qe&255<<8*(De?Te:1-Te))>>>8*(De?Te:1-Te)}function ye(Pe,qe,Ne,De){0>qe&&(qe=4294967295+qe+1);for(var Te=0,Le=_Mathmin(Pe.length-Ne,4);Te<Le;++Te)Pe[Ne+Te]=255&qe>>>8*(De?Te:3-Te)}function be(Pe,qe,Ne,De){if(Ne+De>Pe.length)throw new RangeError('Index out of range');if(0>Ne)throw new RangeError('Index out of range')}function xe(Pe,qe,Ne,De,Te){return Te||be(Pe,qe,Ne,4,3.4028234663852886e38,-3.4028234663852886e38),Me.write(Pe,qe,Ne,De,23,4),Ne+4}function ke(Pe,qe,Ne,De,Te){return Te||be(Pe,qe,Ne,8,1.7976931348623157e308,-1.7976931348623157e308),Me.write(Pe,qe,Ne,De,52,8),Ne+8}function je(Pe){if(Pe=we(Pe).replace(Ee,''),2>Pe.length)return'';for(;0!=Pe.length%4;)Pe+='=';return Pe}function we(Pe){return Pe.trim?Pe.trim():Pe.replace(/^\s+|\s+$/g,'')}function Ce(Pe){return 16>Pe?'0'+Pe.toString(16):Pe.toString(16)}function Se(Pe,qe){qe=qe||Infinity;for(var Ne,De=Pe.length,Te=null,Le=[],Ue=0;Ue<De;++Ue){if(Ne=Pe.charCodeAt(Ue),55295<Ne&&57344>Ne){if(!Te){if(56319<Ne){-1<(qe-=3)&&Le.push(239,191,189);continue}else if(Ue+1===De){-1<(qe-=3)&&Le.push(239,191,189);continue}Te=Ne;continue}if(56320>Ne){-1<(qe-=3)&&Le.push(239,191,189),Te=Ne;continue}Ne=(Te-55296<<10|Ne-56320)+65536}else Te&&-1<(qe-=3)&&Le.push(239,191,189);if(Te=null,128>Ne){if(0>(qe-=1))break;Le.push(Ne)}else if(2048>Ne){if(0>(qe-=2))break;Le.push(192|Ne>>6,128|63&Ne)}else if(65536>Ne){if(0>(qe-=3))break;Le.push(224|Ne>>12,128|63&Ne>>6,128|63&Ne)}else if(1114112>Ne){if(0>(qe-=4))break;Le.push(240|Ne>>18,128|63&Ne>>12,128|63&Ne>>6,128|63&Ne)}else throw new Error('Invalid code point')}return Le}function He(Pe){for(var qe=[],Ne=0;Ne<Pe.length;++Ne)qe.push(255&Pe.charCodeAt(Ne));return qe}function Oe(Pe,qe){for(var Ne,De,Te,Le=[],Ue=0;Ue<Pe.length&&!(0>(qe-=2));++Ue)Ne=Pe.charCodeAt(Ue),De=Ne>>8,Te=Ne%256,Le.push(Te),Le.push(De);return Le}function Ae(Pe){return Ie.toByteArray(je(Pe))}function Ke(Pe,qe,Ne,De){for(var Te=0;Te<De&&!(Te+Ne>=qe.length||Te>=Pe.length);++Te)qe[Te+Ne]=Pe[Te];return Te}function ve(Pe){return Pe!==Pe}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */var Ie=C(22),Me=C(27),Be=C(28);u.Buffer=K,u.SlowBuffer=function(Pe){return+Pe!=Pe&&(Pe=0),K.alloc(+Pe)},u.INSPECT_MAX_BYTES=50,K.TYPED_ARRAY_SUPPORT=S.TYPED_ARRAY_SUPPORT===void 0?function(){try{var Pe=new Uint8Array(1);return Pe.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===Pe.foo()&&'function'==typeof Pe.subarray&&0===Pe.subarray(1,1).byteLength}catch(qe){return!1}}():S.TYPED_ARRAY_SUPPORT,u.kMaxLength=_(),K.poolSize=8192,K._augment=function(Pe){return Pe.__proto__=K.prototype,Pe},K.from=function(Pe,qe,Ne){return I(null,Pe,qe,Ne)},K.TYPED_ARRAY_SUPPORT&&(K.prototype.__proto__=Uint8Array.prototype,K.__proto__=Uint8Array,'undefined'!=typeof Symbol&&Symbol.species&&K[Symbol.species]===K&&Object.defineProperty(K,Symbol.species,{value:null,configurable:!0})),K.alloc=function(Pe,qe,Ne){return R(null,Pe,qe,Ne)},K.allocUnsafe=function(Pe){return E(null,Pe)},K.allocUnsafeSlow=function(Pe){return E(null,Pe)},K.isBuffer=function(qe){return!!(null!=qe&&qe._isBuffer)},K.compare=function(qe,Ne){if(!K.isBuffer(qe)||!K.isBuffer(Ne))throw new TypeError('Arguments must be Buffers');if(qe===Ne)return 0;for(var De=qe.length,Te=Ne.length,Le=0,Ue=_Mathmin(De,Te);Le<Ue;++Le)if(qe[Le]!==Ne[Le]){De=qe[Le],Te=Ne[Le];break}return De<Te?-1:Te<De?1:0},K.isEncoding=function(qe){switch((qe+'').toLowerCase()){case'hex':case'utf8':case'utf-8':case'ascii':case'latin1':case'binary':case'base64':case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return!0;default:return!1;}},K.concat=function(qe,Ne){if(!Be(qe))throw new TypeError('"list" argument must be an Array of Buffers');if(0===qe.length)return K.alloc(0);var De;if(Ne===void 0)for(Ne=0,De=0;De<qe.length;++De)Ne+=qe[De].length;var Te=K.allocUnsafe(Ne),Le=0;for(De=0;De<qe.length;++De){var Ue=qe[De];if(!K.isBuffer(Ue))throw new TypeError('"list" argument must be an Array of Buffers');Ue.copy(Te,Le),Le+=Ue.length}return Te},K.byteLength=J,K.prototype._isBuffer=!0,K.prototype.swap16=function(){var qe=this.length;if(0!=qe%2)throw new RangeError('Buffer size must be a multiple of 16-bits');for(var Ne=0;Ne<qe;Ne+=2)W(this,Ne,Ne+1);return this},K.prototype.swap32=function(){var qe=this.length;if(0!=qe%4)throw new RangeError('Buffer size must be a multiple of 32-bits');for(var Ne=0;Ne<qe;Ne+=4)W(this,Ne,Ne+3),W(this,Ne+1,Ne+2);return this},K.prototype.swap64=function(){var qe=this.length;if(0!=qe%8)throw new RangeError('Buffer size must be a multiple of 64-bits');for(var Ne=0;Ne<qe;Ne+=8)W(this,Ne,Ne+7),W(this,Ne+1,Ne+6),W(this,Ne+2,Ne+5),W(this,Ne+3,Ne+4);return this},K.prototype.toString=function(){var qe=0|this.length;return 0==qe?'':0===arguments.length?le(this,0,qe):$.apply(this,arguments)},K.prototype.equals=function(qe){if(!K.isBuffer(qe))throw new TypeError('Argument must be a Buffer');return this===qe||0===K.compare(this,qe)},K.prototype.inspect=function(){var qe='',Ne=u.INSPECT_MAX_BYTES;return 0<this.length&&(qe=this.toString('hex',0,Ne).match(/.{2}/g).join(' '),this.length>Ne&&(qe+=' ... ')),'<Buffer '+qe+'>'},K.prototype.compare=function(qe,Ne,De,Te,Le){if(!K.isBuffer(qe))throw new TypeError('Argument must be a Buffer');if(void 0===Ne&&(Ne=0),void 0===De&&(De=qe?qe.length:0),void 0===Te&&(Te=0),void 0===Le&&(Le=this.length),0>Ne||De>qe.length||0>Te||Le>this.length)throw new RangeError('out of range index');if(Te>=Le&&Ne>=De)return 0;if(Te>=Le)return-1;if(Ne>=De)return 1;if(Ne>>>=0,De>>>=0,Te>>>=0,Le>>>=0,this===qe)return 0;for(var Ue=Le-Te,Ve=De-Ne,Fe=_Mathmin(Ue,Ve),ze=this.slice(Te,Le),Ye=qe.slice(Ne,De),Ze=0;Ze<Fe;++Ze)if(ze[Ze]!==Ye[Ze]){Ue=ze[Ze],Ve=Ye[Ze];break}return Ue<Ve?-1:Ve<Ue?1:0},K.prototype.includes=function(qe,Ne,De){return-1!==this.indexOf(qe,Ne,De)},K.prototype.indexOf=function(qe,Ne,De){return G(this,qe,Ne,De,!0)},K.prototype.lastIndexOf=function(qe,Ne,De){return G(this,qe,Ne,De,!1)},K.prototype.write=function(qe,Ne,De,Te){if(void 0===Ne)Te='utf8',De=this.length,Ne=0;else if(void 0===De&&'string'==typeof Ne)Te=Ne,De=this.length,Ne=0;else if(isFinite(Ne))Ne|=0,isFinite(De)?(De|=0,void 0===Te&&(Te='utf8')):(Te=De,De=void 0);else throw new Error('Buffer.write(string, encoding, offset[, length]) is no longer supported');var Le=this.length-Ne;if((void 0===De||De>Le)&&(De=Le),0<qe.length&&(0>De||0>Ne)||Ne>this.length)throw new RangeError('Attempt to write outside buffer bounds');Te||(Te='utf8');for(var Ue=!1;;)switch(Te){case'hex':return te(this,qe,Ne,De);case'utf8':case'utf-8':return oe(this,qe,Ne,De);case'ascii':return ne(this,qe,Ne,De);case'latin1':case'binary':return ie(this,qe,Ne,De);case'base64':return se(this,qe,Ne,De);case'ucs2':case'ucs-2':case'utf16le':case'utf-16le':return re(this,qe,Ne,De);default:if(Ue)throw new TypeError('Unknown encoding: '+Te);Te=(''+Te).toLowerCase(),Ue=!0;}},K.prototype.toJSON=function(){return{type:'Buffer',data:Array.prototype.slice.call(this._arr||this,0)}};var Re=4096;K.prototype.slice=function(qe,Ne){var De=this.length;qe=~~qe,Ne=Ne===void 0?De:~~Ne,0>qe?(qe+=De,0>qe&&(qe=0)):qe>De&&(qe=De),0>Ne?(Ne+=De,0>Ne&&(Ne=0)):Ne>De&&(Ne=De),Ne<qe&&(Ne=qe);var Te;if(K.TYPED_ARRAY_SUPPORT)Te=this.subarray(qe,Ne),Te.__proto__=K.prototype;else{var Le=Ne-qe;Te=new K(Le,void 0);for(var Ue=0;Ue<Le;++Ue)Te[Ue]=this[Ue+qe]}return Te},K.prototype.readUIntLE=function(qe,Ne,De){qe|=0,Ne|=0,De||ge(qe,Ne,this.length);for(var Te=this[qe],Le=1,Ue=0;++Ue<Ne&&(Le*=256);)Te+=this[qe+Ue]*Le;return Te},K.prototype.readUIntBE=function(qe,Ne,De){qe|=0,Ne|=0,De||ge(qe,Ne,this.length);for(var Te=this[qe+--Ne],Le=1;0<Ne&&(Le*=256);)Te+=this[qe+--Ne]*Le;return Te},K.prototype.readUInt8=function(qe,Ne){return Ne||ge(qe,1,this.length),this[qe]},K.prototype.readUInt16LE=function(qe,Ne){return Ne||ge(qe,2,this.length),this[qe]|this[qe+1]<<8},K.prototype.readUInt16BE=function(qe,Ne){return Ne||ge(qe,2,this.length),this[qe]<<8|this[qe+1]},K.prototype.readUInt32LE=function(qe,Ne){return Ne||ge(qe,4,this.length),(this[qe]|this[qe+1]<<8|this[qe+2]<<16)+16777216*this[qe+3]},K.prototype.readUInt32BE=function(qe,Ne){return Ne||ge(qe,4,this.length),16777216*this[qe]+(this[qe+1]<<16|this[qe+2]<<8|this[qe+3])},K.prototype.readIntLE=function(qe,Ne,De){qe|=0,Ne|=0,De||ge(qe,Ne,this.length);for(var Te=this[qe],Le=1,Ue=0;++Ue<Ne&&(Le*=256);)Te+=this[qe+Ue]*Le;return Le*=128,Te>=Le&&(Te-=_Mathpow(2,8*Ne)),Te},K.prototype.readIntBE=function(qe,Ne,De){qe|=0,Ne|=0,De||ge(qe,Ne,this.length);for(var Te=Ne,Le=1,Ue=this[qe+--Te];0<Te&&(Le*=256);)Ue+=this[qe+--Te]*Le;return Le*=128,Ue>=Le&&(Ue-=_Mathpow(2,8*Ne)),Ue},K.prototype.readInt8=function(qe,Ne){return Ne||ge(qe,1,this.length),128&this[qe]?-1*(255-this[qe]+1):this[qe]},K.prototype.readInt16LE=function(qe,Ne){Ne||ge(qe,2,this.length);var De=this[qe]|this[qe+1]<<8;return 32768&De?4294901760|De:De},K.prototype.readInt16BE=function(qe,Ne){Ne||ge(qe,2,this.length);var De=this[qe+1]|this[qe]<<8;return 32768&De?4294901760|De:De},K.prototype.readInt32LE=function(qe,Ne){return Ne||ge(qe,4,this.length),this[qe]|this[qe+1]<<8|this[qe+2]<<16|this[qe+3]<<24},K.prototype.readInt32BE=function(qe,Ne){return Ne||ge(qe,4,this.length),this[qe]<<24|this[qe+1]<<16|this[qe+2]<<8|this[qe+3]},K.prototype.readFloatLE=function(qe,Ne){return Ne||ge(qe,4,this.length),Me.read(this,qe,!0,23,4)},K.prototype.readFloatBE=function(qe,Ne){return Ne||ge(qe,4,this.length),Me.read(this,qe,!1,23,4)},K.prototype.readDoubleLE=function(qe,Ne){return Ne||ge(qe,8,this.length),Me.read(this,qe,!0,52,8)},K.prototype.readDoubleBE=function(qe,Ne){return Ne||ge(qe,8,this.length),Me.read(this,qe,!1,52,8)},K.prototype.writeUIntLE=function(qe,Ne,De,Te){if(qe=+qe,Ne|=0,De|=0,!Te){var Le=_Mathpow(2,8*De)-1;fe(this,qe,Ne,De,Le,0)}var Ue=1,Ve=0;for(this[Ne]=255&qe;++Ve<De&&(Ue*=256);)this[Ne+Ve]=255&qe/Ue;return Ne+De},K.prototype.writeUIntBE=function(qe,Ne,De,Te){if(qe=+qe,Ne|=0,De|=0,!Te){var Le=_Mathpow(2,8*De)-1;fe(this,qe,Ne,De,Le,0)}var Ue=De-1,Ve=1;for(this[Ne+Ue]=255&qe;0<=--Ue&&(Ve*=256);)this[Ne+Ue]=255&qe/Ve;return Ne+De},K.prototype.writeUInt8=function(qe,Ne,De){return qe=+qe,Ne|=0,De||fe(this,qe,Ne,1,255,0),K.TYPED_ARRAY_SUPPORT||(qe=_Mathfloor(qe)),this[Ne]=255&qe,Ne+1},K.prototype.writeUInt16LE=function(qe,Ne,De){return qe=+qe,Ne|=0,De||fe(this,qe,Ne,2,65535,0),K.TYPED_ARRAY_SUPPORT?(this[Ne]=255&qe,this[Ne+1]=qe>>>8):he(this,qe,Ne,!0),Ne+2},K.prototype.writeUInt16BE=function(qe,Ne,De){return qe=+qe,Ne|=0,De||fe(this,qe,Ne,2,65535,0),K.TYPED_ARRAY_SUPPORT?(this[Ne]=qe>>>8,this[Ne+1]=255&qe):he(this,qe,Ne,!1),Ne+2},K.prototype.writeUInt32LE=function(qe,Ne,De){return qe=+qe,Ne|=0,De||fe(this,qe,Ne,4,4294967295,0),K.TYPED_ARRAY_SUPPORT?(this[Ne+3]=qe>>>24,this[Ne+2]=qe>>>16,this[Ne+1]=qe>>>8,this[Ne]=255&qe):ye(this,qe,Ne,!0),Ne+4},K.prototype.writeUInt32BE=function(qe,Ne,De){return qe=+qe,Ne|=0,De||fe(this,qe,Ne,4,4294967295,0),K.TYPED_ARRAY_SUPPORT?(this[Ne]=qe>>>24,this[Ne+1]=qe>>>16,this[Ne+2]=qe>>>8,this[Ne+3]=255&qe):ye(this,qe,Ne,!1),Ne+4},K.prototype.writeIntLE=function(qe,Ne,De,Te){if(qe=+qe,Ne|=0,!Te){var Le=_Mathpow(2,8*De-1);fe(this,qe,Ne,De,Le-1,-Le)}var Ue=0,Ve=1,Fe=0;for(this[Ne]=255&qe;++Ue<De&&(Ve*=256);)0>qe&&0==Fe&&0!==this[Ne+Ue-1]&&(Fe=1),this[Ne+Ue]=255&(qe/Ve>>0)-Fe;return Ne+De},K.prototype.writeIntBE=function(qe,Ne,De,Te){if(qe=+qe,Ne|=0,!Te){var Le=_Mathpow(2,8*De-1);fe(this,qe,Ne,De,Le-1,-Le)}var Ue=De-1,Ve=1,Fe=0;for(this[Ne+Ue]=255&qe;0<=--Ue&&(Ve*=256);)0>qe&&0==Fe&&0!==this[Ne+Ue+1]&&(Fe=1),this[Ne+Ue]=255&(qe/Ve>>0)-Fe;return Ne+De},K.prototype.writeInt8=function(qe,Ne,De){return qe=+qe,Ne|=0,De||fe(this,qe,Ne,1,127,-128),K.TYPED_ARRAY_SUPPORT||(qe=_Mathfloor(qe)),0>qe&&(qe=255+qe+1),this[Ne]=255&qe,Ne+1},K.prototype.writeInt16LE=function(qe,Ne,De){return qe=+qe,Ne|=0,De||fe(this,qe,Ne,2,32767,-32768),K.TYPED_ARRAY_SUPPORT?(this[Ne]=255&qe,this[Ne+1]=qe>>>8):he(this,qe,Ne,!0),Ne+2},K.prototype.writeInt16BE=function(qe,Ne,De){return qe=+qe,Ne|=0,De||fe(this,qe,Ne,2,32767,-32768),K.TYPED_ARRAY_SUPPORT?(this[Ne]=qe>>>8,this[Ne+1]=255&qe):he(this,qe,Ne,!1),Ne+2},K.prototype.writeInt32LE=function(qe,Ne,De){return qe=+qe,Ne|=0,De||fe(this,qe,Ne,4,2147483647,-2147483648),K.TYPED_ARRAY_SUPPORT?(this[Ne]=255&qe,this[Ne+1]=qe>>>8,this[Ne+2]=qe>>>16,this[Ne+3]=qe>>>24):ye(this,qe,Ne,!0),Ne+4},K.prototype.writeInt32BE=function(qe,Ne,De){return qe=+qe,Ne|=0,De||fe(this,qe,Ne,4,2147483647,-2147483648),0>qe&&(qe=4294967295+qe+1),K.TYPED_ARRAY_SUPPORT?(this[Ne]=qe>>>24,this[Ne+1]=qe>>>16,this[Ne+2]=qe>>>8,this[Ne+3]=255&qe):ye(this,qe,Ne,!1),Ne+4},K.prototype.writeFloatLE=function(qe,Ne,De){return xe(this,qe,Ne,!0,De)},K.prototype.writeFloatBE=function(qe,Ne,De){return xe(this,qe,Ne,!1,De)},K.prototype.writeDoubleLE=function(qe,Ne,De){return ke(this,qe,Ne,!0,De)},K.prototype.writeDoubleBE=function(qe,Ne,De){return ke(this,qe,Ne,!1,De)},K.prototype.copy=function(qe,Ne,De,Te){if(De||(De=0),Te||0===Te||(Te=this.length),Ne>=qe.length&&(Ne=qe.length),Ne||(Ne=0),0<Te&&Te<De&&(Te=De),Te===De)return 0;if(0===qe.length||0===this.length)return 0;if(0>Ne)throw new RangeError('targetStart out of bounds');if(0>De||De>=this.length)throw new RangeError('sourceStart out of bounds');if(0>Te)throw new RangeError('sourceEnd out of bounds');Te>this.length&&(Te=this.length),qe.length-Ne<Te-De&&(Te=qe.length-Ne+De);var Ue,Le=Te-De;if(this===qe&&De<Ne&&Ne<Te)for(Ue=Le-1;0<=Ue;--Ue)qe[Ue+Ne]=this[Ue+De];else if(1e3>Le||!K.TYPED_ARRAY_SUPPORT)for(Ue=0;Ue<Le;++Ue)qe[Ue+Ne]=this[Ue+De];else Uint8Array.prototype.set.call(qe,this.subarray(De,De+Le),Ne);return Le},K.prototype.fill=function(qe,Ne,De,Te){if('string'==typeof qe){if('string'==typeof Ne?(Te=Ne,Ne=0,De=this.length):'string'==typeof De&&(Te=De,De=this.length),1===qe.length){var Le=qe.charCodeAt(0);256>Le&&(qe=Le)}if(void 0!==Te&&'string'!=typeof Te)throw new TypeError('encoding must be a string');if('string'==typeof Te&&!K.isEncoding(Te))throw new TypeError('Unknown encoding: '+Te)}else'number'==typeof qe&&(qe&=255);if(0>Ne||this.length<Ne||this.length<De)throw new RangeError('Out of range index');if(De<=Ne)return this;Ne>>>=0,De=De===void 0?this.length:De>>>0,qe||(qe=0);var Ue;if('number'==typeof qe)for(Ue=Ne;Ue<De;++Ue)this[Ue]=qe;else{var Ve=K.isBuffer(qe)?qe:Se(new K(qe,Te).toString()),Fe=Ve.length;for(Ue=0;Ue<De-Ne;++Ue)this[Ue+Ne]=Ve[Ue%Fe]}return this};var Ee=/[^+\/0-9A-Za-z-_]/g}).call(u,C(48))},function(o,u){'use strict';u.hypotenuse=function(O,_){var A;return _Mathabs(O)>_Mathabs(_)?(A=_/O,_Mathabs(O)*_Mathsqrt(1+A*A)):0===_?0:(A=O/_,_Mathabs(_)*_Mathsqrt(1+A*A))},u.getEmpty2DArray=function(S,O){for(var _=Array(S),A=0;A<S;A++)_[A]=Array(O);return _},u.getFilled2DArray=function(S,O,_){for(var A=Array(S),K=0;K<S;K++){A[K]=Array(O);for(var I=0;I<O;I++)A[K][I]=_}return A}},function(o,u,C){'use strict';u.array=C(13),u.matrix=C(45)},function(o,u,C){'use strict';function S(T,F){for(var Z=[],Q=T;Q<=F;Q++)Z.push(Q);return Z}function O(T){var F={};_(T.formedSpecies,F),_(T.components,F),A(T.components),K(T)}function _(T,F){for(var Q,Z=0;Z<T.length;Z++){if(Q=T[Z].label,void 0===Q||null===Q)throw new Error('Labels must be defined');if(F[Q])throw new Error('Labels should be unique');F[Q]=!0}}function A(T){for(var F=0;F<T.length;F++)if('number'!=typeof T[F].total&&'number'!=typeof T[F].atEquilibrium)throw new Error('Component should have a property total or atEquilibrium that is a number')}function K(T){var F=T.formedSpecies;if(!F)throw new Error('Formed species is not defined');for(var Q,Z=0;Z<F.length;Z++){if(Q=F[Z],!Q.components||Q.components.length!==T.components.length)throw new Error('Formed species\' components array should have the same size as components');if('number'!=typeof Q.beta)throw new Error('All formed species should have a beta property')}}function I(T,F){for(var Z=0,Q=0;Q<T.length;Q++)F(T[Q])&&++Z;return Z}var M=C(12),R=C(21),E=C(19),P={robustMaxTries:10,volume:1,random:Math.random,autoInitial:!0,tolerance:1e-15};o.exports=class{constructor(T,F){this.options=Object.assign({},P,F),O(T),this.model=T,this._model=this._processModel(T)}_getInitial(){for(var T=this._initial?Object.keys(this._initial):[],F=Array(this._model.nComp),Z=Array(this._model.specSolidLabels.length),Q=0;Q<T.length;Q++){var J=T[Q],$=this._model.compLabels.indexOf(J);-1===$?($=this._model.specSolidLabels.indexOf(J),-1!==$&&(Z[$]=this._initial[J])):F[$]=this._initial[J]}for(Q=0;Q<F.length;Q++)void 0===F[Q]&&(F[Q]=R.logarithmic(this.options.random));for(Q=0;Q<Z.length;Q++)void 0===Z[Q]&&(Z[Q]=R.logarithmic(this.options.random));return{components:F,solids:Z}}_processModel(T){var F=T.formedSpecies.length,Z=T.components.length,J=I(T.formedSpecies,(xe)=>!xe.solid),$=Z+F-J-Z,W=T.formedSpecies.filter((xe)=>!xe.solid),G=T.formedSpecies.filter((xe)=>xe.solid),ee=new M(1,J+Z).fill(1);if(ee.setSubMatrix([W.map((xe)=>xe.beta)],0,Z),$)var te=new M([G.map((xe)=>xe.beta)]);var oe=new M(Z,J+Z),ne=M.identity(T.components.length);oe.setSubMatrix(ne,0,0);var ie=[];for(fe=0;fe<Z;fe++)for(var se=0;se<J;se++)oe.set(fe,se+Z,W[se].components[fe]);for(fe=0;fe<Z;fe++){var re=T.components[fe].atEquilibrium;if(!re)ie.push(fe);else{var ae=new M(1,J+Z).fill(re);ae.pow([oe.getRow(fe)]),ee.multiply(ae)}}var le=ie.concat(S(Z,Z+J-1));if(oe=oe.selection(ie,le),ee=ee.selection([0],le),$){ie=[];var pe=new M(Z,$);for(fe=0;fe<Z;fe++)for(se=0;se<$;se++)pe.set(fe,se,G[se].components[fe]);for(fe=0;fe<Z;fe++)re=T.components[fe].atEquilibrium,re?(ae=new M(1,$).fill(re),ae.pow([pe.getRow(fe)]),te.multiply(ae)):ie.push(fe);le=S(0,$-1),pe=pe.selection(ie,le),te=te.selection([0],le),te.pow(-1)}for(var he,ce=[],me=[],de=[],ue=[],ge=[],fe=0;fe<Z;fe++)he=T.components[fe],he.atEquilibrium?(me.push(he.label),de.push(he.atEquilibrium/this.options.volume)):(ge.push(he.total/this.options.volume),ce.push(he.label),ue.push(he.label));var ye=W.map((xe)=>xe.label),be=G.map((xe)=>xe.label);return ce=ce.concat(ye,be),{model:oe.to2DArray(),beta:ee.to1DArray(),cTotal:ge,cFixed:de,specLabels:ce,compLabels:ue,fixedLabels:me,specSolidLabels:be,specSolutionLabels:ye,nFixed:Z-oe.rows,solidModel:pe&&pe.to2DArray(),solidBeta:te&&te.to1DArray()}}solve(){var T=this._model,F=this._getInitial(),Z=E(T.model,T.beta,T.cTotal,F.components,T.solidModel,T.solidBeta,F.solids,this.options),Q=this._processResult(Z);return this.options.autoInitial&&this.setInitial(Q),Q}solveRobust(){for(var T=this._model,F=0;F<this.options.robustMaxTries;F++){var Z={components:R.logarithmic(this.options.random,T.compLabels.length),solids:R.logarithmic(this.options.random,T.specSolidLabels.length)},Q=E(T.model,T.beta,T.cTotal,Z.components,T.solidModel,T.solidBeta,Z.solids,this.options);if(Q)return this._processResult(Q)}return null}setInitial(T){for(var J,F=Object.assign({},T),Z=Object.keys(F),Q=0;Q<Z.length;Q++)J=Z[Q],0===F[J]&&(F[J]=1e-15);this._initial=F}_processResult(T){if(!T)return null;for(var F={},Z=0;Z<this._model.specLabels.length;Z++)F[this._model.specLabels[Z]]=T[Z];for(Z=0;Z<this._model.cFixed.length;Z++)F[this._model.fixedLabels[Z]]=this._model.cFixed[Z];return F}}},function(o,u,C){o.exports=C(26)},function(o,u,C){'use strict';(function(S){u.__esModule=!0;var _=Object.prototype.toString,A='undefined'==typeof S?function(){return!1}:function(R){return S.isBuffer(R)},K='function'==typeof Object.keys?function(R){return Object.keys(R)}:function(R){var E=typeof R;if(null===R||'function'!=E&&'object'!=E)throw new TypeError('obj must be an Object');var P=[],D=void 0;for(D in R)Object.prototype.hasOwnProperty.call(R,D)&&P.push(D);return P},I='function'==typeof Symbol?function(R){return Object.getOwnPropertySymbols(R)}:function(){return[]};u.getKeys=K,u.getSymbols=I,u.indexOf=function(M,R){if('[object Array]'!==_.call(M))throw new TypeError('array must be an Array');var E=void 0,P,D;for(E=0,P=M.length;E<P;++E)if(D=M[E],D===R||D!==D&&R!==R)return E;return-1},u.isBuffer=A}).call(u,C(3).Buffer)},function(module,exports,__webpack_require__){'use strict';function abstractMatrix(superCtor){function checkDimensions(o,u){if(o.rows!==u.rows||o.columns!==u.columns)throw new RangeError('Matrices dimensions must be equal')}function compareNumbers(o,u){return o-u}function fillTemplateFunction(o,u){for(var C in u)o=o.replace(new RegExp('%'+C+'%','g'),u[C]);return o}superCtor===void 0&&(superCtor=Object);class Matrix extends superCtor{static get[Symbol.species](){return this}static from1DArray(o,u,C){if(o*u!==C.length)throw new RangeError('Data length does not match given dimensions');for(var O=new this(o,u),_=0;_<o;_++)for(var A=0;A<u;A++)O.set(_,A,C[_*u+A]);return O}static rowVector(o){for(var u=new this(1,o.length),C=0;C<o.length;C++)u.set(0,C,o[C]);return u}static columnVector(o){for(var u=new this(o.length,1),C=0;C<o.length;C++)u.set(C,0,o[C]);return u}static empty(o,u){return new this(o,u)}static zeros(o,u){return this.empty(o,u).fill(0)}static ones(o,u){return this.empty(o,u).fill(1)}static rand(o,u,C){C===void 0&&(C=Math.random);for(var S=this.empty(o,u),O=0;O<o;O++)for(var _=0;_<u;_++)S.set(O,_,C());return S}static randInt(o,u,C,S){C===void 0&&(C=1e3),S===void 0&&(S=Math.random);for(var O=this.empty(o,u),_=0;_<o;_++)for(var K,A=0;A<u;A++)K=_Mathfloor(S()*C),O.set(_,A,K);return O}static eye(o,u,C){u===void 0&&(u=o),C===void 0&&(C=1);for(var S=_Mathmin(o,u),O=this.zeros(o,u),_=0;_<S;_++)O.set(_,_,C);return O}static diag(o,u,C){var S=o.length;u===void 0&&(u=S),C===void 0&&(C=u);for(var O=_Mathmin(S,u,C),_=this.zeros(u,C),A=0;A<O;A++)_.set(A,A,o[A]);return _}static min(o,u){o=this.checkMatrix(o),u=this.checkMatrix(u);for(var C=o.rows,S=o.columns,O=new this(C,S),_=0;_<C;_++)for(var A=0;A<S;A++)O.set(_,A,_Mathmin(o.get(_,A),u.get(_,A)));return O}static max(o,u){o=this.checkMatrix(o),u=this.checkMatrix(u);for(var C=o.rows,S=o.columns,O=new this(C,S),_=0;_<C;_++)for(var A=0;A<S;A++)O.set(_,A,_Mathmax(o.get(_,A),u.get(_,A)));return O}static checkMatrix(o){return Matrix.isMatrix(o)?o:new this(o)}static isMatrix(o){return null!=o&&'Matrix'===o.klass}get size(){return this.rows*this.columns}apply(o){if('function'!=typeof o)throw new TypeError('callback must be a function');for(var u=this.rows,C=this.columns,S=0;S<u;S++)for(var O=0;O<C;O++)o.call(this,S,O);return this}to1DArray(){for(var o=Array(this.size),u=0;u<this.rows;u++)for(var C=0;C<this.columns;C++)o[u*this.columns+C]=this.get(u,C);return o}to2DArray(){for(var o=Array(this.rows),u=0;u<this.rows;u++){o[u]=Array(this.columns);for(var C=0;C<this.columns;C++)o[u][C]=this.get(u,C)}return o}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var o=0;o<this.rows;o++)for(var u=0;u<=o;u++)if(this.get(o,u)!==this.get(u,o))return!1;return!0}return!1}set(){throw new Error('set method is unimplemented')}get(){throw new Error('get method is unimplemented')}repeat(o,u){o=o||1,u=u||1;for(var C=new this.constructor[Symbol.species](this.rows*o,this.columns*u),S=0;S<o;S++)for(var O=0;O<u;O++)C.setSubMatrix(this,this.rows*S,this.columns*O);return C}fill(o){for(var u=0;u<this.rows;u++)for(var C=0;C<this.columns;C++)this.set(u,C,o);return this}neg(){return this.mulS(-1)}getRow(o){util.checkRowIndex(this,o);for(var u=Array(this.columns),C=0;C<this.columns;C++)u[C]=this.get(o,C);return u}getRowVector(o){return this.constructor.rowVector(this.getRow(o))}setRow(o,u){util.checkRowIndex(this,o),u=util.checkRowVector(this,u);for(var C=0;C<this.columns;C++)this.set(o,C,u[C]);return this}swapRows(o,u){util.checkRowIndex(this,o),util.checkRowIndex(this,u);for(var S,C=0;C<this.columns;C++)S=this.get(o,C),this.set(o,C,this.get(u,C)),this.set(u,C,S);return this}getColumn(o){util.checkColumnIndex(this,o);for(var u=Array(this.rows),C=0;C<this.rows;C++)u[C]=this.get(C,o);return u}getColumnVector(o){return this.constructor.columnVector(this.getColumn(o))}setColumn(o,u){util.checkColumnIndex(this,o),u=util.checkColumnVector(this,u);for(var C=0;C<this.rows;C++)this.set(C,o,u[C]);return this}swapColumns(o,u){util.checkColumnIndex(this,o),util.checkColumnIndex(this,u);for(var S,C=0;C<this.rows;C++)S=this.get(C,o),this.set(C,o,this.get(C,u)),this.set(C,u,S);return this}addRowVector(o){o=util.checkRowVector(this,o);for(var u=0;u<this.rows;u++)for(var C=0;C<this.columns;C++)this.set(u,C,this.get(u,C)+o[C]);return this}subRowVector(o){o=util.checkRowVector(this,o);for(var u=0;u<this.rows;u++)for(var C=0;C<this.columns;C++)this.set(u,C,this.get(u,C)-o[C]);return this}mulRowVector(o){o=util.checkRowVector(this,o);for(var u=0;u<this.rows;u++)for(var C=0;C<this.columns;C++)this.set(u,C,this.get(u,C)*o[C]);return this}divRowVector(o){o=util.checkRowVector(this,o);for(var u=0;u<this.rows;u++)for(var C=0;C<this.columns;C++)this.set(u,C,this.get(u,C)/o[C]);return this}addColumnVector(o){o=util.checkColumnVector(this,o);for(var u=0;u<this.rows;u++)for(var C=0;C<this.columns;C++)this.set(u,C,this.get(u,C)+o[u]);return this}subColumnVector(o){o=util.checkColumnVector(this,o);for(var u=0;u<this.rows;u++)for(var C=0;C<this.columns;C++)this.set(u,C,this.get(u,C)-o[u]);return this}mulColumnVector(o){o=util.checkColumnVector(this,o);for(var u=0;u<this.rows;u++)for(var C=0;C<this.columns;C++)this.set(u,C,this.get(u,C)*o[u]);return this}divColumnVector(o){o=util.checkColumnVector(this,o);for(var u=0;u<this.rows;u++)for(var C=0;C<this.columns;C++)this.set(u,C,this.get(u,C)/o[u]);return this}mulRow(o,u){util.checkRowIndex(this,o);for(var C=0;C<this.columns;C++)this.set(o,C,this.get(o,C)*u);return this}mulColumn(o,u){util.checkColumnIndex(this,o);for(var C=0;C<this.rows;C++)this.set(C,o,this.get(C,o)*u);return this}max(){for(var o=this.get(0,0),u=0;u<this.rows;u++)for(var C=0;C<this.columns;C++)this.get(u,C)>o&&(o=this.get(u,C));return o}maxIndex(){for(var o=this.get(0,0),u=[0,0],C=0;C<this.rows;C++)for(var S=0;S<this.columns;S++)this.get(C,S)>o&&(o=this.get(C,S),u[0]=C,u[1]=S);return u}min(){for(var o=this.get(0,0),u=0;u<this.rows;u++)for(var C=0;C<this.columns;C++)this.get(u,C)<o&&(o=this.get(u,C));return o}minIndex(){for(var o=this.get(0,0),u=[0,0],C=0;C<this.rows;C++)for(var S=0;S<this.columns;S++)this.get(C,S)<o&&(o=this.get(C,S),u[0]=C,u[1]=S);return u}maxRow(o){util.checkRowIndex(this,o);for(var u=this.get(o,0),C=1;C<this.columns;C++)this.get(o,C)>u&&(u=this.get(o,C));return u}maxRowIndex(o){util.checkRowIndex(this,o);for(var u=this.get(o,0),C=[o,0],S=1;S<this.columns;S++)this.get(o,S)>u&&(u=this.get(o,S),C[1]=S);return C}minRow(o){util.checkRowIndex(this,o);for(var u=this.get(o,0),C=1;C<this.columns;C++)this.get(o,C)<u&&(u=this.get(o,C));return u}minRowIndex(o){util.checkRowIndex(this,o);for(var u=this.get(o,0),C=[o,0],S=1;S<this.columns;S++)this.get(o,S)<u&&(u=this.get(o,S),C[1]=S);return C}maxColumn(o){util.checkColumnIndex(this,o);for(var u=this.get(0,o),C=1;C<this.rows;C++)this.get(C,o)>u&&(u=this.get(C,o));return u}maxColumnIndex(o){util.checkColumnIndex(this,o);for(var u=this.get(0,o),C=[0,o],S=1;S<this.rows;S++)this.get(S,o)>u&&(u=this.get(S,o),C[0]=S);return C}minColumn(o){util.checkColumnIndex(this,o);for(var u=this.get(0,o),C=1;C<this.rows;C++)this.get(C,o)<u&&(u=this.get(C,o));return u}minColumnIndex(o){util.checkColumnIndex(this,o);for(var u=this.get(0,o),C=[0,o],S=1;S<this.rows;S++)this.get(S,o)<u&&(u=this.get(S,o),C[0]=S);return C}diag(){for(var o=_Mathmin(this.rows,this.columns),u=Array(o),C=0;C<o;C++)u[C]=this.get(C,C);return u}sum(o){return'row'===o?util.sumByRow(this):'column'===o?util.sumByColumn(this):util.sumAll(this)}mean(){return this.sum()/this.size}prod(){for(var o=1,u=0;u<this.rows;u++)for(var C=0;C<this.columns;C++)o*=this.get(u,C);return o}cumulativeSum(){for(var o=0,u=0;u<this.rows;u++)for(var C=0;C<this.columns;C++)o+=this.get(u,C),this.set(u,C,o);return this}dot(o){Matrix.isMatrix(o)&&(o=o.to1DArray());var u=this.to1DArray();if(u.length!==o.length)throw new RangeError('vectors do not have the same size');for(var C=0,S=0;S<u.length;S++)C+=u[S]*o[S];return C}mmul(o){o=this.constructor.checkMatrix(o),this.columns!==o.rows&&console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');for(var u=this.rows,C=this.columns,S=o.columns,O=new this.constructor[Symbol.species](u,S),_=Array(C),A=0;A<S;A++){for(var K=0;K<C;K++)_[K]=o.get(K,A);for(var M,I=0;I<u;I++){for(M=0,K=0;K<C;K++)M+=this.get(I,K)*_[K];O.set(I,A,M)}}return O}strassen2x2(o){var u=new this.constructor[Symbol.species](2,2);const C=this.get(0,0),S=o.get(0,0),O=this.get(0,1),_=o.get(0,1),A=this.get(1,0),K=o.get(1,0),I=this.get(1,1),M=o.get(1,1),R=(C+I)*(S+M),E=(A+I)*S,P=C*(_-M),D=I*(K-S),T=(C+O)*M;return u.set(0,0,R+D-T+(O-I)*(K+M)),u.set(0,1,P+T),u.set(1,0,E+D),u.set(1,1,R-E+P+(A-C)*(S+_)),u}strassen3x3(o){var u=new this.constructor[Symbol.species](3,3);const C=this.get(0,0),S=this.get(0,1),O=this.get(0,2),_=this.get(1,0),A=this.get(1,1),K=this.get(1,2),I=this.get(2,0),M=this.get(2,1),R=this.get(2,2),E=o.get(0,0),P=o.get(0,1),D=o.get(0,2),T=o.get(1,0),F=o.get(1,1),Z=o.get(1,2),Q=o.get(2,0),J=o.get(2,1),$=o.get(2,2),G=(C-_)*(-P+F),te=(-C+_+A)*(E-P+F),oe=(_+A)*(-E+P),ne=C*E,ie=(-C+I+M)*(E-D+Z),se=(-C+I)*(D-Z),re=(I+M)*(-E+D),pe=(-O+M+R)*(F+Q-J),ce=(O-R)*(F-J),me=O*Q,de=(M+R)*(-Q+J),ue=(-O+A+K)*(Z+Q-$),ge=(O-K)*(Z-$),fe=(A+K)*(-Q+$);return u.set(0,0,ne+me+S*T),u.set(0,1,(C+S+O-_-A-M-R)*F+te+oe+ne+pe+me+de),u.set(0,2,ne+ie+re+(C+S+O-A-K-I-M)*Z+me+ue+fe),u.set(1,0,G+A*(-E+P+T-F-Z-Q+$)+te+ne+me+ue+ge),u.set(1,1,G+te+oe+ne+K*J),u.set(1,2,me+ue+ge+fe+_*D),u.set(2,0,ne+ie+se+M*(-E+D+T-F-Z-Q+J)+pe+ce+me),u.set(2,1,pe+ce+me+de+I*P),u.set(2,2,ne+ie+se+re+R*$),u}mmulStrassen(o){function u(R,E,P){var D=R.rows,T=R.columns;if(D===E&&T===P)return R;var F=Matrix.zeros(E,P);return F=F.setSubMatrix(R,0,0),F}function C(R,E,P,D){if(512>=P||512>=D)return R.mmul(E);1==P%2&&1==D%2?(R=u(R,P+1,D+1),E=u(E,P+1,D+1)):1==P%2?(R=u(R,P+1,D),E=u(E,P+1,D)):1==D%2&&(R=u(R,P,D+1),E=u(E,P,D+1));var T=parseInt(R.rows/2),F=parseInt(R.columns/2),Z=R.subMatrix(0,T-1,0,F-1),Q=E.subMatrix(0,T-1,0,F-1),J=R.subMatrix(0,T-1,F,R.columns-1),$=E.subMatrix(0,T-1,F,E.columns-1),W=R.subMatrix(T,R.rows-1,0,F-1),G=E.subMatrix(T,E.rows-1,0,F-1),ee=R.subMatrix(T,R.rows-1,F,R.columns-1),te=E.subMatrix(T,E.rows-1,F,E.columns-1),oe=C(Matrix.add(Z,ee),Matrix.add(Q,te),T,F),ne=C(Matrix.add(W,ee),Q,T,F),ie=C(Z,Matrix.sub($,te),T,F),se=C(ee,Matrix.sub(G,Q),T,F),re=C(Matrix.add(Z,J),te,T,F),ae=C(Matrix.sub(W,Z),Matrix.add(Q,$),T,F),le=C(Matrix.sub(J,ee),Matrix.add(G,te),T,F),pe=Matrix.add(oe,se);pe.sub(re),pe.add(le);var ce=Matrix.add(ie,re),me=Matrix.add(ne,se),de=Matrix.sub(oe,ne);de.add(ie),de.add(ae);var ue=Matrix.zeros(2*pe.rows,2*pe.columns);return ue=ue.setSubMatrix(pe,0,0),ue=ue.setSubMatrix(ce,pe.rows,0),ue=ue.setSubMatrix(me,0,pe.columns),ue=ue.setSubMatrix(de,pe.rows,pe.columns),ue.subMatrix(0,P-1,0,D-1)}var S=this.clone(),O=S.rows,_=S.columns,A=o.rows,K=o.columns;_!==A&&console.warn(`Multiplying ${O} x ${_} and ${A} x ${K} matrix: dimensions do not match.`);var I=_Mathmax(O,A),M=_Mathmax(_,K);return S=u(S,I,M),o=u(o,I,M),C(S,o,I,M)}scaleRows(o,u){if(o=void 0===o?0:o,u=void 0===u?1:u,o>=u)throw new RangeError('min should be strictly smaller than max');for(var O,C=this.constructor.empty(this.rows,this.columns),S=0;S<this.rows;S++)O=arrayUtils.scale(this.getRow(S),{min:o,max:u}),C.setRow(S,O);return C}scaleColumns(o,u){if(o=void 0===o?0:o,u=void 0===u?1:u,o>=u)throw new RangeError('min should be strictly smaller than max');for(var O,C=this.constructor.empty(this.rows,this.columns),S=0;S<this.columns;S++)O=arrayUtils.scale(this.getColumn(S),{min:o,max:u}),C.setColumn(S,O);return C}kroneckerProduct(o){o=this.constructor.checkMatrix(o);for(var u=this.rows,C=this.columns,S=o.rows,O=o.columns,_=new this.constructor[Symbol.species](u*S,C*O),A=0;A<u;A++)for(var K=0;K<C;K++)for(var I=0;I<S;I++)for(var M=0;M<O;M++)_[S*A+I][O*K+M]=this.get(A,K)*o.get(I,M);return _}transpose(){for(var o=new this.constructor[Symbol.species](this.columns,this.rows),u=0;u<this.rows;u++)for(var C=0;C<this.columns;C++)o.set(C,u,this.get(u,C));return o}sortRows(o){o===void 0&&(o=compareNumbers);for(var u=0;u<this.rows;u++)this.setRow(u,this.getRow(u).sort(o));return this}sortColumns(o){o===void 0&&(o=compareNumbers);for(var u=0;u<this.columns;u++)this.setColumn(u,this.getColumn(u).sort(o));return this}subMatrix(o,u,C,S){util.checkRange(this,o,u,C,S);for(var O=new this.constructor[Symbol.species](u-o+1,S-C+1),_=o;_<=u;_++)for(var A=C;A<=S;A++)O[_-o][A-C]=this.get(_,A);return O}subMatrixRow(o,u,C){if(void 0===u&&(u=0),void 0===C&&(C=this.columns-1),u>C||0>u||u>=this.columns||0>C||C>=this.columns)throw new RangeError('Argument out of range');for(var S=new this.constructor[Symbol.species](o.length,C-u+1),O=0;O<o.length;O++)for(var _=u;_<=C;_++){if(0>o[O]||o[O]>=this.rows)throw new RangeError('Row index out of range: '+o[O]);S.set(O,_-u,this.get(o[O],_))}return S}subMatrixColumn(o,u,C){if(void 0===u&&(u=0),void 0===C&&(C=this.rows-1),u>C||0>u||u>=this.rows||0>C||C>=this.rows)throw new RangeError('Argument out of range');for(var S=new this.constructor[Symbol.species](C-u+1,o.length),O=0;O<o.length;O++)for(var _=u;_<=C;_++){if(0>o[O]||o[O]>=this.columns)throw new RangeError('Column index out of range: '+o[O]);S.set(_-u,O,this.get(_,o[O]))}return S}setSubMatrix(o,u,C){o=this.constructor.checkMatrix(o);var S=u+o.rows-1,O=C+o.columns-1;util.checkRange(this,u,S,C,O);for(var _=0;_<o.rows;_++)for(var A=0;A<o.columns;A++)this[u+_][C+A]=o.get(_,A);return this}selection(o,u){for(var _,C=util.checkIndices(this,o,u),S=new this.constructor[Symbol.species](o.length,u.length),O=0;O<C.row.length;O++){_=C.row[O];for(var K,A=0;A<C.column.length;A++)K=C.column[A],S[O][A]=this.get(_,K)}return S}trace(){for(var o=_Mathmin(this.rows,this.columns),u=0,C=0;C<o;C++)u+=this.get(C,C);return u}transposeView(){return new MatrixTransposeView(this)}rowView(o){return util.checkRowIndex(this,o),new MatrixRowView(this,o)}columnView(o){return util.checkColumnIndex(this,o),new MatrixColumnView(this,o)}flipRowView(){return new MatrixFlipRowView(this)}flipColumnView(){return new MatrixFlipColumnView(this)}subMatrixView(o,u,C,S){return new MatrixSubView(this,o,u,C,S)}selectionView(o,u){return new MatrixSelectionView(this,o,u)}det(){if(this.isSquare()){var o,u,C,S;if(2===this.columns)return o=this.get(0,0),u=this.get(0,1),C=this.get(1,0),S=this.get(1,1),o*S-u*C;if(3===this.columns){var O,_,A;return O=this.selectionView([1,2],[1,2]),_=this.selectionView([1,2],[0,2]),A=this.selectionView([1,2],[0,1]),o=this.get(0,0),u=this.get(0,1),C=this.get(0,2),o*O.det()-u*_.det()+C*A.det()}return new LuDecomposition(this).determinant}throw Error('Determinant can only be calculated for a square matrix.')}pseudoInverse(o){void 0===o&&(o=Number.EPSILON);for(var u=new SvDecomposition(this,{autoTranspose:!0}),C=u.leftSingularVectors,S=u.rightSingularVectors,O=u.diagonal,_=0;_<O.length;_++)O[_]=_Mathabs(O[_])>o?1/O[_]:0;return O=this.constructor[Symbol.species].diag(O),S.mmul(O.mmul(C.transposeView()))}}Matrix.prototype.klass='Matrix',Matrix.random=Matrix.rand,Matrix.diagonal=Matrix.diag,Matrix.prototype.diagonal=Matrix.prototype.diag,Matrix.identity=Matrix.eye,Matrix.prototype.negate=Matrix.prototype.neg,Matrix.prototype.tensorProduct=Matrix.prototype.kroneckerProduct,Matrix.prototype.determinant=Matrix.prototype.det;var inplaceOperator=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,inplaceOperatorScalar=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% value);
        }
    }
    return this;
})
`,inplaceOperatorMatrix=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));
        }
    }
    return this;
})
`,staticOperator=`
(function %name%(matrix, value) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(value);
})
`,inplaceMethod=`
(function %name%() {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j)));
        }
    }
    return this;
})
`,staticMethod=`
(function %name%(matrix) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%();
})
`,inplaceMethodWithArgs=`
(function %name%(%args%) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), %args%));
        }
    }
    return this;
})
`,staticMethodWithArgs=`
(function %name%(matrix, %args%) {
    var newMatrix = new this[Symbol.species](matrix);
    return newMatrix.%name%(%args%);
})
`,inplaceMethodWithOneArgScalar=`
(function %name%S(value) {
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), value));
        }
    }
    return this;
})
`,inplaceMethodWithOneArgMatrix=`
(function %name%M(matrix) {
    matrix = this.constructor.checkMatrix(matrix);
    checkDimensions(this, matrix);
    for (var i = 0; i < this.rows; i++) {
        for (var j = 0; j < this.columns; j++) {
            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));
        }
    }
    return this;
})
`,inplaceMethodWithOneArg=`
(function %name%(value) {
    if (typeof value === 'number') return this.%name%S(value);
    return this.%name%M(value);
})
`,staticMethodWithOneArg=staticMethodWithArgs,operators=[['+','add'],['-','sub','subtract'],['*','mul','multiply'],['/','div','divide'],['%','mod','modulus'],['&','and'],['|','or'],['^','xor'],['<<','leftShift'],['>>','signPropagatingRightShift'],['>>>','rightShift','zeroFillRightShift']],i;for(var operator of operators){var inplaceOp=eval(fillTemplateFunction(inplaceOperator,{name:operator[1],op:operator[0]})),inplaceOpS=eval(fillTemplateFunction(inplaceOperatorScalar,{name:operator[1]+'S',op:operator[0]})),inplaceOpM=eval(fillTemplateFunction(inplaceOperatorMatrix,{name:operator[1]+'M',op:operator[0]})),staticOp=eval(fillTemplateFunction(staticOperator,{name:operator[1]}));for(i=1;i<operator.length;i++)Matrix.prototype[operator[i]]=inplaceOp,Matrix.prototype[operator[i]+'S']=inplaceOpS,Matrix.prototype[operator[i]+'M']=inplaceOpM,Matrix[operator[i]]=staticOp}var methods=[['~','not']];['abs','acos','acosh','asin','asinh','atan','atanh','cbrt','ceil','clz32','cos','cosh','exp','expm1','floor','fround','log','log1p','log10','log2','round','sign','sin','sinh','sqrt','tan','tanh','trunc'].forEach(function(o){methods.push(['Math.'+o,o])});for(var method of methods){var inplaceMeth=eval(fillTemplateFunction(inplaceMethod,{name:method[1],method:method[0]})),staticMeth=eval(fillTemplateFunction(staticMethod,{name:method[1]}));for(i=1;i<method.length;i++)Matrix.prototype[method[i]]=inplaceMeth,Matrix[method[i]]=staticMeth}var methodsWithArgs=[['Math.pow',1,'pow']];for(var methodWithArg of methodsWithArgs){var args='arg0';for(i=1;i<methodWithArg[1];i++)args+=`, arg${i}`;if(1!==methodWithArg[1]){var inplaceMethWithArgs=eval(fillTemplateFunction(inplaceMethodWithArgs,{name:methodWithArg[2],method:methodWithArg[0],args:args})),staticMethWithArgs=eval(fillTemplateFunction(staticMethodWithArgs,{name:methodWithArg[2],args:args}));for(i=2;i<methodWithArg.length;i++)Matrix.prototype[methodWithArg[i]]=inplaceMethWithArgs,Matrix[methodWithArg[i]]=staticMethWithArgs}else{var tmplVar={name:methodWithArg[2],args:args,method:methodWithArg[0]},inplaceMethod2=eval(fillTemplateFunction(inplaceMethodWithOneArg,tmplVar)),inplaceMethodS=eval(fillTemplateFunction(inplaceMethodWithOneArgScalar,tmplVar)),inplaceMethodM=eval(fillTemplateFunction(inplaceMethodWithOneArgMatrix,tmplVar)),staticMethod2=eval(fillTemplateFunction(staticMethodWithOneArg,tmplVar));for(i=2;i<methodWithArg.length;i++)Matrix.prototype[methodWithArg[i]]=inplaceMethod2,Matrix.prototype[methodWithArg[i]+'M']=inplaceMethodM,Matrix.prototype[methodWithArg[i]+'S']=inplaceMethodS,Matrix[methodWithArg[i]]=staticMethod2}}return Matrix}module.exports=abstractMatrix;var LuDecomposition=__webpack_require__(10),SvDecomposition=__webpack_require__(11),arrayUtils=__webpack_require__(31),util=__webpack_require__(2),MatrixTransposeView=__webpack_require__(44),MatrixRowView=__webpack_require__(41),MatrixSubView=__webpack_require__(43),MatrixSelectionView=__webpack_require__(42),MatrixColumnView=__webpack_require__(38),MatrixFlipRowView=__webpack_require__(40),MatrixFlipColumnView=__webpack_require__(39)},function(o,u,C){'use strict';function S(_){if(!(this instanceof S))return new S(_);_=O.Matrix.checkMatrix(_);var E,P,D,T,F,Z,Q,J,$,W,A=_.clone(),K=A.rows,I=A.columns,M=Array(K),R=1;for(E=0;E<K;E++)M[E]=E;for($=Array(K),P=0;P<I;P++){for(E=0;E<K;E++)$[E]=A[E][P];for(E=0;E<K;E++){for(J=A[E],W=_Mathmin(E,P),F=0,D=0;D<W;D++)F+=J[D]*$[D];J[P]=$[E]-=F}for(T=P,E=P+1;E<K;E++)_Mathabs($[E])>_Mathabs($[T])&&(T=E);if(T!==P){for(D=0;D<I;D++)Z=A[T][D],A[T][D]=A[P][D],A[P][D]=Z;Q=M[T],M[T]=M[P],M[P]=Q,R=-R}if(P<K&&0!==A[P][P])for(E=P+1;E<K;E++)A[E][P]/=A[P][P]}this.LU=A,this.pivotVector=M,this.pivotSign=R}var O=C(0);S.prototype={isSingular:function(){for(var _=this.LU,A=_.columns,K=0;K<A;K++)if(0===_[K][K])return!0;return!1},get determinant(){var _=this.LU;if(!_.isSquare())throw new Error('Matrix must be square');for(var A=this.pivotSign,K=_.columns,I=0;I<K;I++)A*=_[I][I];return A},get lowerTriangularMatrix(){for(var _=this.LU,A=_.rows,K=_.columns,I=new O.Matrix(A,K),M=0;M<A;M++)for(var R=0;R<K;R++)I[M][R]=M>R?_[M][R]:M===R?1:0;return I},get upperTriangularMatrix(){for(var _=this.LU,A=_.rows,K=_.columns,I=new O.Matrix(A,K),M=0;M<A;M++)for(var R=0;R<K;R++)I[M][R]=M<=R?_[M][R]:0;return I},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(_){_=O.Matrix.checkMatrix(_);var A=this.LU,K=A.rows;if(K!==_.rows)throw new Error('Invalid matrix dimensions');if(this.isSingular())throw new Error('LU matrix is singular');var I=_.columns,M=_.subMatrixRow(this.pivotVector,0,I-1),R=A.columns,E,P,D;for(D=0;D<R;D++)for(E=D+1;E<R;E++)for(P=0;P<I;P++)M[E][P]-=M[D][P]*A[E][D];for(D=R-1;0<=D;D--){for(P=0;P<I;P++)M[D][P]/=A[D][D];for(E=0;E<D;E++)for(P=0;P<I;P++)M[E][P]-=M[D][P]*A[E][D]}return M}},o.exports=S},function(o,u,C){'use strict';function S(I,M){if(!(this instanceof S))return new S(I,M);I=O.Matrix.checkMatrix(I),M=M||{};var R=I.rows,E=I.columns,P=_Mathmin(R,E),D=!0,T=!0;!1===M.computeLeftSingularVectors&&(D=!1),!1===M.computeRightSingularVectors&&(T=!1);var Q,F=!0===M.autoTranspose,Z=!1;if(!(R<E))Q=I.clone();else if(!F)Q=I.clone(),console.warn('Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose');else{Q=I.transpose(),R=Q.rows,E=Q.columns,Z=!0;var J=D;D=T,T=J}var ie,se,re,ae,le,pe,ce,me,de,ue,ge,fe,he,ye,be,xe,ke,je,we,Ce,Se,$=Array(_Mathmin(R+1,E)),W=K(R,P,0),G=K(E,E,0),ee=Array(E),te=Array(R),oe=_Mathmin(R-1,E),ne=_Mathmax(0,_Mathmin(E-2,R));for(re=0,ue=_Mathmax(oe,ne);re<ue;re++){if(re<oe){for($[re]=0,ie=re;ie<R;ie++)$[re]=A($[re],Q[ie][re]);if(0!==$[re]){for(0>Q[re][re]&&($[re]=-$[re]),ie=re;ie<R;ie++)Q[ie][re]/=$[re];Q[re][re]+=1}$[re]=-$[re]}for(se=re+1;se<E;se++){if(re<oe&&0!==$[re]){for(le=0,ie=re;ie<R;ie++)le+=Q[ie][re]*Q[ie][se];for(le=-le/Q[re][re],ie=re;ie<R;ie++)Q[ie][se]+=le*Q[ie][re]}ee[se]=Q[re][se]}if(D&&re<oe)for(ie=re;ie<R;ie++)W[ie][re]=Q[ie][re];if(re<ne){for(ee[re]=0,ie=re+1;ie<E;ie++)ee[re]=A(ee[re],ee[ie]);if(0!==ee[re]){for(0>ee[re+1]&&(ee[re]=0-ee[re]),ie=re+1;ie<E;ie++)ee[ie]/=ee[re];ee[re+1]+=1}if(ee[re]=-ee[re],re+1<R&&0!==ee[re]){for(ie=re+1;ie<R;ie++)te[ie]=0;for(se=re+1;se<E;se++)for(ie=re+1;ie<R;ie++)te[ie]+=ee[se]*Q[ie][se];for(se=re+1;se<E;se++)for(le=-ee[se]/ee[re+1],ie=re+1;ie<R;ie++)Q[ie][se]+=le*te[ie]}if(T)for(ie=re+1;ie<E;ie++)G[ie][re]=ee[ie]}}if(ae=_Mathmin(E,R+1),oe<E&&($[oe]=Q[oe][oe]),R<ae&&($[ae-1]=0),ne+1<ae&&(ee[ne]=Q[ne][ae-1]),ee[ae-1]=0,D){for(se=oe;se<P;se++){for(ie=0;ie<R;ie++)W[ie][se]=0;W[se][se]=1}for(re=oe-1;0<=re;re--)if(0!==$[re]){for(se=re+1;se<P;se++){for(le=0,ie=re;ie<R;ie++)le+=W[ie][re]*W[ie][se];for(le=-le/W[re][re],ie=re;ie<R;ie++)W[ie][se]+=le*W[ie][re]}for(ie=re;ie<R;ie++)W[ie][re]=-W[ie][re];for(W[re][re]=1+W[re][re],ie=0;ie<re-1;ie++)W[ie][re]=0}else{for(ie=0;ie<R;ie++)W[ie][re]=0;W[re][re]=1}}if(T)for(re=E-1;0<=re;re--){if(re<ne&&0!==ee[re])for(se=re+1;se<E;se++){for(le=0,ie=re+1;ie<E;ie++)le+=G[ie][re]*G[ie][se];for(le=-le/G[re+1][re],ie=re+1;ie<E;ie++)G[ie][se]+=le*G[ie][re]}for(ie=0;ie<E;ie++)G[ie][re]=0;G[re][re]=1}for(var He=ae-1,Oe=0,Ae=2.220446049250313e-16;0<ae;){for(re=ae-2;-1<=re&&-1!==re;re--)if(_Mathabs(ee[re])<=Ae*(_Mathabs($[re])+_Mathabs($[re+1]))){ee[re]=0;break}if(re===ae-2)ge=4;else{for(pe=ae-1;pe>=re&&pe!==re;pe--)if(le=(pe===ae?0:_Mathabs(ee[pe]))+(pe===re+1?0:_Mathabs(ee[pe-1])),_Mathabs($[pe])<=Ae*le){$[pe]=0;break}pe===re?ge=3:pe===ae-1?ge=1:(ge=2,re=pe)}switch(re++,ge){case 1:{for(ce=ee[ae-2],ee[ae-2]=0,se=ae-2;se>=re;se--)if(le=A($[se],ce),me=$[se]/le,de=ce/le,$[se]=le,se!==re&&(ce=-de*ee[se-1],ee[se-1]=me*ee[se-1]),T)for(ie=0;ie<E;ie++)le=me*G[ie][se]+de*G[ie][ae-1],G[ie][ae-1]=-de*G[ie][se]+me*G[ie][ae-1],G[ie][se]=le;break}case 2:{for(ce=ee[re-1],ee[re-1]=0,se=re;se<ae;se++)if(le=A($[se],ce),me=$[se]/le,de=ce/le,$[se]=le,ce=-de*ee[se],ee[se]=me*ee[se],D)for(ie=0;ie<R;ie++)le=me*W[ie][se]+de*W[ie][re-1],W[ie][re-1]=-de*W[ie][se]+me*W[ie][re-1],W[ie][se]=le;break}case 3:{for(fe=_Mathmax(_Mathmax(_Mathmax(_Mathmax(_Mathabs($[ae-1]),_Mathabs($[ae-2])),_Mathabs(ee[ae-2])),_Mathabs($[re])),_Mathabs(ee[re])),he=$[ae-1]/fe,ye=$[ae-2]/fe,be=ee[ae-2]/fe,xe=$[re]/fe,ke=ee[re]/fe,je=((ye+he)*(ye-he)+be*be)/2,we=he*be*(he*be),Ce=0,(0!==je||0!==we)&&(Ce=_Mathsqrt(je*je+we),0>je&&(Ce=-Ce),Ce=we/(je+Ce)),ce=(xe+he)*(xe-he)+Ce,Se=xe*ke,se=re;se<ae-1;se++){if(le=A(ce,Se),me=ce/le,de=Se/le,se!==re&&(ee[se-1]=le),ce=me*$[se]+de*ee[se],ee[se]=me*ee[se]-de*$[se],Se=de*$[se+1],$[se+1]=me*$[se+1],T)for(ie=0;ie<E;ie++)le=me*G[ie][se]+de*G[ie][se+1],G[ie][se+1]=-de*G[ie][se]+me*G[ie][se+1],G[ie][se]=le;if(le=A(ce,Se),me=ce/le,de=Se/le,$[se]=le,ce=me*ee[se]+de*$[se+1],$[se+1]=-de*ee[se]+me*$[se+1],Se=de*ee[se+1],ee[se+1]=me*ee[se+1],D&&se<R-1)for(ie=0;ie<R;ie++)le=me*W[ie][se]+de*W[ie][se+1],W[ie][se+1]=-de*W[ie][se]+me*W[ie][se+1],W[ie][se]=le}ee[ae-2]=ce,++Oe;break}case 4:{if(0>=$[re]&&($[re]=0>$[re]?-$[re]:0,T))for(ie=0;ie<=He;ie++)G[ie][re]=-G[ie][re];for(;re<He&&!($[re]>=$[re+1]);){if(le=$[re],$[re]=$[re+1],$[re+1]=le,T&&re<E-1)for(ie=0;ie<E;ie++)le=G[ie][re+1],G[ie][re+1]=G[ie][re],G[ie][re]=le;if(D&&re<R-1)for(ie=0;ie<R;ie++)le=W[ie][re+1],W[ie][re+1]=W[ie][re],W[ie][re]=le;re++}Oe=0,ae--;break}}}if(Z){var Ke=G;G=W,W=Ke}this.m=R,this.n=E,this.s=$,this.U=W,this.V=G}var O=C(0),_=C(4),A=_.hypotenuse,K=_.getFilled2DArray;S.prototype={get condition(){return this.s[0]/this.s[_Mathmin(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){for(var M=_Mathmax(this.m,this.n)*this.s[0]*2.220446049250313e-16,R=0,E=this.s,P=0,D=E.length;P<D;P++)E[P]>M&&R++;return R},get diagonal(){return this.s},get threshold(){return 2.220446049250313e-16/2*_Mathmax(this.m,this.n)*this.s[0]},get leftSingularVectors(){return O.Matrix.isMatrix(this.U)||(this.U=new O.Matrix(this.U)),this.U},get rightSingularVectors(){return O.Matrix.isMatrix(this.V)||(this.V=new O.Matrix(this.V)),this.V},get diagonalMatrix(){return O.Matrix.diag(this.s)},solve:function(I){var D,R=this.threshold,E=this.s.length,P=O.Matrix.zeros(E,E);for(D=0;D<E;D++)P[D][D]=_Mathabs(this.s[D])<=R?0:1/this.s[D];var T=this.U,F=this.rightSingularVectors,Z=F.mmul(P),Q=F.rows,J=T.length,$=O.Matrix.zeros(Q,J),W,G,ee;for(D=0;D<Q;D++)for(W=0;W<J;W++){for(ee=0,G=0;G<E;G++)ee+=Z[D][G]*T[W][G];$[D][W]=ee}return $.mmul(I)},solveForDiagonal:function(I){return this.solve(O.Matrix.diag(I))},inverse:function(){var I=this.V,M=this.threshold,R=I.length,E=I[0].length,P=new O.Matrix(R,this.s.length),D,T;for(D=0;D<R;D++)for(T=0;T<E;T++)P[D][T]=_Mathabs(this.s[T])>M?I[D][T]/this.s[T]:0;var F=this.U,Z=F.length,Q=F[0].length,J=new O.Matrix(R,Z),$,W;for(D=0;D<R;D++)for(T=0;T<Z;T++){for(W=0,$=0;$<Q;$++)W+=P[D][$]*F[T][$];J[D][T]=W}return J}},o.exports=S},function(o,u,C){'use strict';o.exports=C(0).Matrix,o.exports.Decompositions=o.exports.DC=C(36)},function(o,u){'use strict';function S(O,_){return O-_}u.sum=function(_){for(var O=0,A=0;A<_.length;A++)O+=_[A];return O},u.max=function(_){for(var O=_[0],A=_.length,K=1;K<A;K++)_[K]>O&&(O=_[K]);return O},u.min=function(_){for(var O=_[0],A=_.length,K=1;K<A;K++)_[K]<O&&(O=_[K]);return O},u.minMax=function(_){for(var A=_[0],K=_[0],I=_.length,M=1;M<I;M++)_[M]<A&&(A=_[M]),_[M]>K&&(K=_[M]);return{min:A,max:K}},u.arithmeticMean=function(_){for(var A=0,K=_.length,I=0;I<K;I++)A+=_[I];return A/K},u.mean=u.arithmeticMean,u.geometricMean=function(_){for(var A=1,K=_.length,I=0;I<K;I++)A*=_[I];return _Mathpow(A,1/K)},u.logMean=function(_){for(var A=0,K=_.length,I=0;I<K;I++)A+=_Mathlog(_[I]);return A/K},u.grandMean=function(_,A){for(var K=0,I=0,M=_.length,R=0;R<M;R++)K+=A[R]*_[R],I+=A[R];return K/I},u.truncatedMean=function(_,A,K){K===void 0&&(K=!1),K||(_=[].concat(_).sort(S));for(var I=_.length,M=_Mathfloor(I*A),R=0,E=M;E<I-M;E++)R+=_[E];return R/(I-2*M)},u.harmonicMean=function(_){for(var A=0,K=_.length,I=0;I<K;I++){if(0===_[I])throw new RangeError('value at index '+I+'is zero');A+=1/_[I]}return K/A},u.contraHarmonicMean=function(_){for(var A=0,K=0,I=_.length,M=0;M<I;M++)A+=_[M]*_[M],K+=_[M];if(0>K)throw new RangeError('sum of values is negative');return A/K},u.median=function(_,A){A===void 0&&(A=!1),A||(_=[].concat(_).sort(S));var K=_.length,I=_Mathfloor(K/2);return 0==K%2?0.5*(_[I-1]+_[I]):_[I]},u.variance=function(_,A){A===void 0&&(A=!0);for(var E,K=u.mean(_),I=0,M=_.length,R=0;R<M;R++)E=_[R]-K,I+=E*E;return A?I/(M-1):I/M},u.standardDeviation=function(_,A){return _Mathsqrt(u.variance(_,A))},u.standardError=function(_){return u.standardDeviation(_)/_Mathsqrt(_.length)},u.robustMeanAndStdev=function(_){var A=0,K=0,I=_.length,M=0;for(M=0;M<I;M++)A+=_[M];A/=I;var R=Array(I);for(M=0;M<I;M++)R[M]=_Mathabs(_[M]-A);return R.sort(S),K=1==I%2?R[(I-1)/2]/0.6745:0.5*(R[I/2]+R[I/2-1])/0.6745,{mean:A,stdev:K}},u.quartiles=function(_,A){'undefined'==typeof A&&(A=!1),A||(_=[].concat(_).sort(S));var K=_.length/4,I=_[_Mathceil(K)-1],M=u.median(_,!0),R=_[_Mathceil(3*K)-1];return{q1:I,q2:M,q3:R}},u.pooledStandardDeviation=function(_,A){return _Mathsqrt(u.pooledVariance(_,A))},u.pooledVariance=function(_,A){'undefined'==typeof A&&(A=!0);for(var K=0,I=0,M=_.length,R=0;R<M;R++){var E=_[R],P=u.variance(E);K+=(E.length-1)*P,I+=A?E.length-1:E.length}return K/I},u.mode=function(_){var I,A=_.length,K=Array(A);for(I=0;I<A;I++)K[I]=0;var M=Array(A),R=0;for(I=0;I<A;I++){var E=M.indexOf(_[I]);0<=E?K[E]++:(M[R]=_[I],K[R]=1,R++)}var P=0,D=0;for(I=0;I<R;I++)K[I]>P&&(P=K[I],D=I);return M[D]},u.covariance=function(_,A,K){'undefined'==typeof K&&(K=!0);var I=u.mean(_),M=u.mean(A);if(_.length!==A.length)throw'Vectors do not have the same dimensions';for(var R=0,E=_.length,P=0;P<E;P++){var D=_[P]-I,T=A[P]-M;R+=D*T}return K?R/(E-1):R/E},u.skewness=function(_,A){'undefined'==typeof A&&(A=!0);for(var P,K=u.mean(_),I=0,M=0,R=_.length,E=0;E<R;E++)P=_[E]-K,I+=P*P,M+=P*P*P;var D=I/R,T=M/R,F=T/_Mathpow(D,3/2);if(A){var Z=_Mathsqrt(R*(R-1));return Z/(R-2)*F}return F},u.kurtosis=function(_,A){'undefined'==typeof A&&(A=!0);for(var P,K=u.mean(_),I=_.length,M=0,R=0,E=0;E<I;E++)P=_[E]-K,M+=P*P,R+=P*P*P*P;var D=M/I,T=R/I;if(A){var F=M/(I-1),Q=R/(F*F);return I*(I+1)/((I-1)*(I-2)*(I-3))*Q-3*((I-1)*(I-1)/((I-2)*(I-3)))}return T/(D*D)-3},u.entropy=function(_,A){'undefined'==typeof A&&(A=0);for(var K=0,I=_.length,M=0;M<I;M++)K+=_[M]*_Mathlog(_[M]+A);return-K},u.weightedMean=function(_,A){for(var K=0,I=_.length,M=0;M<I;M++)K+=_[M]*A[M];return K},u.weightedStandardDeviation=function(_,A){return _Mathsqrt(u.weightedVariance(_,A))},u.weightedVariance=function(_,A){for(var K=u.weightedMean(_,A),I=0,M=_.length,R=0,E=0,P=0;P<M;P++){var D=_[P]-K,T=A[P];I+=T*(D*D),E+=T,R+=T*T}return I*(E/(E*E-R))},u.center=function(_,A){'undefined'==typeof A&&(A=!1);var K=_;A||(K=[].concat(_));for(var I=u.mean(K),M=K.length,R=0;R<M;R++)K[R]-=I},u.standardize=function(_,A,K){'undefined'==typeof A&&(A=u.standardDeviation(_)),'undefined'==typeof K&&(K=!1);for(var I=_.length,M=K?_:Array(I),R=0;R<I;R++)M[R]=_[R]/A;return M},u.cumulativeSum=function(_){var A=_.length,K=Array(A);K[0]=_[0];for(var I=1;I<A;I++)K[I]=K[I-1]+_[I];return K}},function(o,u,C){'use strict';function S(R,E){R=A(R);for(var P=[],D=0;D<R.length;D++)('number'!=typeof R[D].pK||'H2O'!==E.solvent)&&(R[D].pK[E.solvent]?R[D].pK=R[D].pK[E.solvent]:P.push(D));for(D=R.length-1;0<=D;D--)-1<P.indexOf(D)&&R.splice(D,1);return R}var O=C(16),_=C(18),A=C(7),K=C(6),I={solvent:'H2O'};class M{constructor(R){this.atEquilibrium=new Set,R=Object.assign({},I,R);var E=R.database||O;R.extend&&R.database&&(E=E.concat(O)),E=S(E,R),this.species={},this.options=R,this.eqSet=new _(E),this.addSpecie(R.solvent)}clone(){var R=new M;return R.species=A(this.species),R.eqSet=this.eqSet.clone(),R.options=A(this.options),R.atEquilibrium=new Set(this.atEquilibrium),R}getSpecies(R){R=R||{};var E=R.filtered?Object.keys(this.species):null,P=Object.assign({},R);return P.species=E,this.eqSet.getSpecies(P)}getComponents(R){R=R||{};var E=R.filtered?Object.keys(this.species):null;if(E)var P=this.eqSet.getSubset(E);else P=this.eqSet;return P.getNormalized(this.options.solvent).getComponents(R)}getEquations(R){R=R||{};var E=this.eqSet;return R.filtered&&(E=this.eqSet.getSubset(Object.keys(this.species))),R.normalized&&(E=E.getNormalized(this.options.solvent)),E.getEquations(R)}getModel(){var R=this.eqSet.getSubset(Object.keys(this.species)),E=R.getNormalized(this.options.solvent),P=E.getModel(this.species,!0);return P.components.forEach((D)=>{this.atEquilibrium.has(D.label)&&(D.atEquilibrium=this.species[D.label],delete D.total)}),P}getEquilibrium(){return new K(this.getModel(),this.options)}addSpecie(R,E){E=E||0,R===this.solvent&&(E=0),this.species[R]?this.species[R]+=E:this.species[R]=E}resetSpecies(){this.species={},this.addSpecie(this.options.solvent)}setTotal(R,E){this.species[R]=E,this.atEquilibrium.delete(R)}setAtEquilibrium(R,E){this.species[R]=E,this.atEquilibrium.add(R)}setOptions(R){this.options=Object.assign({},this.options,R)}disableEquation(R){this.eqSet.disableEquation(R,!0)}enableEquation(R){this.eqSet.enableEquation(R,!0)}enableAllEquations(){this.eqSet.enableAllEquations()}}o.exports=M},function(o){'use strict';function S(A){if(A.from>=A.to)throw new Error('Invalid arguments: property "to" should be larger than "from"');if(!A.varying)throw new Error('Invalid arguments: property "varying" is not defined')}var O={chunks:200,log:!1,from:0,to:1,isFixed:!1};o.exports=class{constructor(A){this.helper=A}getTitration(A){A=Object.assign({},O,A);var K=this.helper.clone();K.resetSpecies(),K.setOptions(A);var I=A.solution.volume,M=A.solution.concentration,E=A.titrationSolution.concentration,P=0,D=A.titrationSolution.volume,T=0,F=[],Z=[],Q=[],J=A.chunks,$;K.addSpecie(A.solution.type),K.addSpecie(A.titrationSolution.type);for(var W=0;W<=J;W++){var G=P+(D-P)*(W/J);K.setTotal(A.titrationSolution.type,G*E),K.setTotal(A.solution.type,M*I),K.setOptions({volume:G+I});var oe=K.getEquilibrium();$?(oe.setInitial($),$=oe.solve()):$=oe.solveRobust(),$?(Z.push(-Math.log10($['H+'])),Q.push($),F.push(G)):T++}for(var ne=[],ie=0;ie<Z.length;ie++)ne.push(F[ie],Z[ie]);var se=Q[0]?Object.keys(Q[0]):[];return{xy:ne,errorCount:T,solutions:Q,species:se,volumes:F,equations:K.getEquations({filtered:!0})}}getSolutions(A){A=Object.assign({},O,A);var K=this.helper.clone();K.setOptions(A),S(A);for(var E,J,I=A.varying,M=0,R=A.chunks,P=[],D=[],T=A.log,F=A.from,Z=A.to,Q=0;Q<=R;Q++){if(J=A.from+(Z-F)*Q/R,T)var $=_Mathpow(10,-J);else $=J;A.isFixed?K.setAtEquilibrium(I,$):K.setTotal(I,$);var W=K.getEquilibrium();E?(W.setInitial(E),E=W.solve()):E=W.solveRobust(),E?(D.push(J),P.push(E)):M++}return{x:D,solutions:P,errorCount:M,species:P[0]?Object.keys(P[0]):[]}}}},function(o){o.exports=[{formed:'HIO3',components:{'IO3-':1,'H+':1},pK:0.8,type:'acidoBasic'},{formed:'HOCN',components:{'OCN-':1,'H+':1},pK:3.48,type:'acidoBasic'},{formed:'HBrO',components:{'BrO-':1,'H+':1},pK:8.6,type:'acidoBasic'},{formed:'CH2ClCO2H',components:{'CH2ClCO2-':1,'H+':1},pK:2.89,type:'acidoBasic'},{formed:'C6H5COOH',components:{'C6H5COO-':1,'H+':1},pK:4.2,type:'acidoBasic'},{formed:'C6H5NH3+',components:{C6H5NH2:1,'H+':1},pK:4.6,type:'acidoBasic'},{formed:'C2H5COOH',components:{'C2H5COO-':1,'H+':1},pK:4.87,type:'acidoBasic'},{formed:'C5H5NH+',components:{C5H5N:1,'H+':1},pK:5.25,type:'acidoBasic'},{formed:'CH3NH3+',components:{CH3NH2:1,'H+':1},pK:10.66,type:'acidoBasic'},{formed:'(C2H5)3NH+',components:{'(C2H5)3N':1,'H+':1},pK:10.75,type:'acidoBasic'},{formed:'C2H5NH3+',components:{C2H5NH2:1,'H+':1},pK:10.8,type:'acidoBasic'},{formed:'HClO4',components:{'ClO4-':1,'H+':1},pK:-7,type:'acidoBasic'},{formed:'HCl',components:{'Cl-':1,'H+':1},pK:-3,type:'acidoBasic'},{formed:'H2SO4',components:{'HSO4-':1,'H+':1},pK:-3,type:'acidoBasic'},{formed:'HNO3',components:{'NO3-':1,'H+':1},pK:-1,type:'acidoBasic'},{formed:'H2SO3',components:{'HSO3-':1,'H+':1},pK:1.8,type:'acidoBasic'},{formed:'HSO4-',components:{'SO4--':1,'H+':1},pK:1.9,type:'acidoBasic'},{formed:'HClO2',components:{'ClO2-':1,'H+':1},pK:1.93,type:'acidoBasic'},{formed:'H2PO3',components:{'HPO3-':1,'H+':1},pK:2,type:'acidoBasic'},{formed:'Fe(H2O)6+++',components:{'Fe(H2O)5OH++':1,'H+':1},pK:2.1,type:'acidoBasic'},{formed:'H3PO4',components:{'H2PO4-':1,'H+':1},pK:2.12,type:'acidoBasic'},{formed:'HF',components:{'F-':1,'H+':1},pK:3.2,type:'acidoBasic'},{formed:'HNO2',components:{'NO2-':1,'H+':1},pK:3.35,type:'acidoBasic'},{formed:'HCO2H',components:{'HCO2-':1,'H+':1},pK:3.75,type:'acidoBasic'},{formed:'CH3CO2H',components:{'CH3COO-':1,'H+':1},pK:4.7,type:'acidoBasic'},{formed:'Al(H2O)6+++',components:{'Al(H2O)5OH++':1,'H+':1},pK:4.9,type:'acidoBasic'},{formed:'H2CO3',components:{'HCO3-':1,'H+':1},pK:6.3,type:'acidoBasic'},{formed:'HPO3-',components:{'PO3--':1,'H+':1},pK:6.59,type:'acidoBasic'},{formed:'H2S',components:{'HS-':1,'H+':1},pK:7.04,type:'acidoBasic'},{formed:'HSO3-',components:{'SO3--':1,'H+':1},pK:7.21,type:'acidoBasic'},{formed:'HClO',components:{'ClO-':1,'H+':1},pK:8,type:'acidoBasic'},{formed:'HCN',components:{'CN-':1,'H+':1},pK:9.2,type:'acidoBasic'},{formed:'NH4+',components:{NH3:1,'H+':1},pK:9.25,type:'acidoBasic'},{formed:'HCO3-',components:{'CO3--':1,'H+':1},pK:10.33,type:'acidoBasic'},{formed:'H2PO4-',components:{'HPO4--':1,'H+':1},pK:7.2,type:'acidoBasic'},{formed:'HPO4--',components:{'PO4---':1,'H+':1},pK:12.32,type:'acidoBasic'},{formed:'H2O',components:{'OH-':1,'H+':1},pK:14,type:'acidoBasic'},{formed:'HS-',components:{'S--':1,'H+':1},pK:19,type:'acidoBasic'},{formed:'NH3',components:{'NH2-':1,'H+':1},pK:23,type:'acidoBasic'},{formed:'Ag(NH3)2+',components:{'Ag+':1,NH3:2},pK:7.2,type:'complexation'},{formed:'Zn(NH3)4++',components:{'Zn++':1,NH3:4},pK:8.89,type:'complexation'},{formed:'Cu(NH3)4++',components:{'Cu++':1,NH3:4},pK:13.04,type:'complexation'},{formed:'Hg(NH3)4++',components:{'Hg++':1,NH3:4},pK:19.26,type:'complexation'},{formed:'Co(NH3)6++',components:{'Co++':1,NH3:6},pK:4.7,type:'complexation'},{formed:'Co(NH3)4+++',components:{'Co+++':1,NH3:4},pK:33.66,type:'complexation'},{formed:'Cd(NH3)6++',components:{'Cd++':1,NH3:6},pK:5.41,type:'complexation'},{formed:'Cd(NH3)4++',components:{'Cd++':1,NH3:4},pK:7,type:'complexation'},{formed:'Ni(NH3)6++',components:{'Ni++':1,NH3:6},pK:8.3,type:'complexation'},{formed:'Fe(CN)6----',components:{'Fe++':1,'CN-':6},pK:35,type:'complexation'},{formed:'Fe(CN)6---',components:{'Fe+++':1,'CN-':6},pK:41.96,type:'complexation'},{formed:'Ag(CN)2-',components:{'Ag+':1,'CN-':2},pK:18.72,type:'complexation'},{formed:'Cu(CN)2-',components:{'Cu+':1,'CN-':2},pK:16,type:'complexation'},{formed:'Cd(CN)4--',components:{'Cd++':1,'CN-':4},pK:16.89,type:'complexation'},{formed:'Au(CN)2-',components:{'Au+':1,'CN-':2},pK:38.3,type:'complexation'},{formed:'Ni(CN)4--',components:{'Ni++':1,'CN-':4},pK:31,type:'complexation'},{formed:'AlF6---',components:{'Al+++':1,'F-':6},pK:4.4,type:'complexation'},{formed:'AlF4-',components:{'Al+++':1,'F-':4},pK:8.3,type:'complexation'},{formed:'BeF4--',components:{'Be++':1,'F-':4},pK:13.11,type:'complexation'},{formed:'SnF6--',components:{'Sn++++':1,'F-':6},pK:25,type:'complexation'},{formed:'CuCl2-',components:{'Cu+':1,'Cl-':2},pK:5.48,type:'complexation'},{formed:'AgCl2-',components:{'Ag+':1,'Cl-':2},pK:5.26,type:'complexation'},{formed:'PbCl4--',components:{'Pb++':1,'Cl-':4},pK:15.4,type:'complexation'},{formed:'HgCl4--',components:{'Hg++':1,'Cl-':4},pK:15.7,type:'complexation'},{formed:'CuBr2-',components:{'Cu+':1,'Br-':2},pK:5.9,type:'complexation'},{formed:'AgBr2-',components:{'Ag+':1,'Br-':2},pK:11,type:'complexation'},{formed:'HgBr4--',components:{'Hg++':1,'Br-':4},pK:4.48,type:'complexation'},{formed:'CuI2-',components:{'Cu+':1,'I-':2},pK:8.9,type:'complexation'},{formed:'AgI2-',components:{'Ag+':1,'I-':2},pK:11,type:'complexation'},{formed:'PbI4--',components:{'Pb++':1,'I-':4},pK:4.48,type:'complexation'},{formed:'HgI4--',components:{'Hg++':1,'I-':4},pK:30.28,type:'complexation'},{formed:'Ag(CH3NH2)2+',components:{'Ag+':1,CH3NH2:2},pK:6.89,type:'complexation'},{formed:'Ag(S2O3)2---',components:{'Ag+':1,'S2O3--':2},pK:13.46,type:'complexation'},{formed:'Cd(SCN)4--',components:{'Cd++':1,'SCN-':4},pK:3,type:'complexation'},{formed:'Cu(SCN)2',components:{'Cu++':1,'SCN-':2},pK:3.75,type:'complexation'},{formed:'Fe(SCN)3',components:{'Fe+++':1,'SCN-':3},pK:6.3,type:'complexation'},{formed:'Hg(SCN)4--',components:{'Hg++':1,'SCN-':4},pK:21.7,type:'complexation'},{formed:'Cu(OH)4--',components:{'Cu++':1,'OH-':4},pK:16.11,type:'complexation'},{formed:'Zn(OH)4--',components:{'Zn++':1,'OH-':4},pK:15.45,type:'complexation'},{formed:'Mn(en)3++',components:{'Mn++':1,en:1},pK:5.81,type:'complexation'},{formed:'Fe(en)3++',components:{'Fe++':1,en:1},pK:9.72,type:'complexation'},{formed:'Co(en)3++',components:{'Co++':1,en:1},pK:14.11,type:'complexation'},{formed:'Co(en)3+++',components:{'Co+++':1,en:1},pK:48.68,type:'complexation'},{formed:'Ni(en)3++',components:{'Ni++':1,en:1},pK:17.61,type:'complexation'},{formed:'Cu(en)2++',components:{'Cu++':1,en:1},pK:19.54,type:'complexation'},{formed:'Co(C2O4)3----',components:{'Co++':1,'C2O4--':3},pK:6.65,type:'complexation'},{formed:'Fe(C2O4)3---',components:{'Fe+++':1,'C2O4--':3},pK:20.52,type:'complexation'},{formed:'AgBr',components:{'Ag+':1,'Br-':1},pK:12.27,type:'precipitation'},{formed:'AgBrO3',components:{'Ag+':1,'BrO3-':1},pK:4.24,type:'precipitation'},{formed:'Ag2CO3',components:{'Ag+':2,'CO3--':1},pK:11.1,type:'precipitation'},{formed:'AgCl',components:{'Ag+':1,'Cl-':1},pK:9.74,type:'precipitation'},{formed:'Ag2CrO4',components:{'Ag+':2,'CrO4--':1},pK:11.05,type:'precipitation'},{formed:'AgI',components:{'Ag+':1,'I-':1},pK:16.07,type:'precipitation'},{formed:'AgOH',components:{'Ag+':1,'OH-':1},pK:7.72,type:'precipitation'},{formed:'Ag2S',components:{'Ag+':2,'S--':1},pK:50.22,type:'precipitation'},{formed:'Al(OH)3',components:{'Al+++':1,'OH-':3},pK:32.74,type:'precipitation'},{formed:'BaCO3',components:{'Ba++':1,'CO3--':1},pK:8.7,type:'precipitation'},{formed:'BaCrO4',components:{'Ba++':1,'CrO4--':1},pK:10.07,type:'precipitation'},{formed:'BaF2',components:{'Ba++':1,'F-':2},pK:6.74,type:'precipitation'},{formed:'BaSO4',components:{'Ba++':1,'SO4--':1},pK:9.96,type:'precipitation'},{formed:'Bi2S3',components:{'Bi+++':2,'S--':3},pK:71.8,type:'precipitation'},{formed:'CaCO3',components:{'Ca++':1,'CO3--':1},pK:8.47,type:'precipitation'},{formed:'CaF2',components:{'Ca++':1,'F-':2},pK:10.46,type:'precipitation'},{formed:'Ca(OH)2',components:{'Ca++':1,'OH-':2},pK:5.3,type:'precipitation'},{formed:'Ca3(PO4)2',components:{'Ca++':3,'PO4---':2},pK:32.68,type:'precipitation'},{formed:'CaSO4',components:{'Ca++':1,'SO4--':1},pK:4.35,type:'precipitation'},{formed:'CdS',components:{'Cd++':1,'S--':1},pK:28,type:'precipitation'},{formed:'CuCl',components:{'Cu+':1,'Cl-':1},pK:6.77,type:'precipitation'},{formed:'Cu(OH)2',components:{'Cu++':1,'OH-':2},pK:18.8,type:'precipitation'},{formed:'CuS',components:{'Cu++':1,'S--':1},pK:44.07,type:'precipitation'},{formed:'Fe(OH)2',components:{'Fe++':1,'OH-':2},pK:16.31,type:'precipitation'},{formed:'Fe(OH)3',components:{'Fe+++':1,'OH-':3},pK:38.55,type:'precipitation'},{formed:'FeS',components:{'Fe++':1,'S--':1},pK:18.22,type:'precipitation'},{formed:'Hg2Cl2',components:{'Hg+':2,'Cl-':2},pK:17.85,type:'precipitation'},{formed:'Li2CO3',components:{'Li+':2,'CO3--':1},pK:2.96,type:'precipitation'},{formed:'MgCO3',components:{'Mg++':1,'CO3--':1},pK:4.17,type:'precipitation'},{formed:'Mg(OH)2',components:{'Mg++':1,'OH-':2},pK:11.15,type:'precipitation'},{formed:'Mn(OH)2',components:{'Mn--':1,'OH-':2},pK:12.7,type:'precipitation'},{formed:'PbCl2',components:{'Pb++':1,'Cl-':2},pK:4.77,type:'precipitation'},{formed:'PbCrO4',components:{'Pb++':1,'CrO4--':1},pK:15.7,type:'precipitation'},{formed:'PbI2',components:{'Pb++':1,'I--':2},pK:7.85,type:'precipitation'},{formed:'Pb(OH)2',components:{'Pb++':1,'OH-':2},pK:14.92,type:'precipitation'},{formed:'PbS',components:{'Pb++':1,'S--':1},pK:28.15,type:'precipitation'},{formed:'PbSO4',components:{'Pb++':1,'SO4--':1},pK:7.8,type:'precipitation'},{formed:'Zn(OH)2',components:{'Zn++':1,'OH-':2},pK:16.35,type:'precipitation'},{formed:'ZnS',components:{'Zn++':1,'S--':1},pK:22.52,type:'precipitation'}]},function(o,u,C){'use strict';var S=C(7),O=['acidoBasic','precipitation','complexation'];class _{constructor(A){if('string'!=typeof A.formed)throw new Error('equation expects a property "formed" that is a string');if('number'!=typeof A.pK)throw new Error('equation expects a property "pK" that is a number');if(-1===O.indexOf(A.type))throw new Error('Unexpected type');if('[object Object]'!==Object.prototype.toString.call(A.components))throw new Error('Unexpected components');if(1>Object.keys(A.components).length)throw new Error('Components is expected to have at least one key');this._eq=S(A)}static create(A){return A instanceof _?A.clone():new _(A)}get pK(){return this._eq.pK}get formed(){return this._eq.formed}get components(){return this._eq.components}get type(){return this._eq.type}clone(){return new _(S(this._eq))}toJSON(){return this._eq}withSolvent(A){var K={},I=this._eq.components,M=this._eq.formed,R=Object.keys(I);if(M===A){K.formed=R[0],K.components={},K.pK=-this._eq.pK,K.type=this._eq.type;for(var P,E=1;E<R.length;E++)P=R[E],K.components[P]=-this._eq.components[P]}else for(var T,D=0;D<R.length;D++)if(T=R[D],T===A){K=S(this._eq),delete K.components[T];break}return K.components?new _(K):this.clone()}}o.exports=_},function(o,u,C){'use strict';(function(S){function O(D){for(var T=D.length,F=Array(T).fill(0),Z=Array(T),Q=0;Q<T;Q++)if(_(D,Q))F[Q]=D[Q];else{var J=Object.keys(D[Q].components);Z[Q]=J.map(function(G){return D.findIndex(function(ee){return ee.formed===G})})}for(var $=0;!A(F)&&10>$;){for(var W=0;W<T;W++)F[W]||A(F,Z[W])&&K(D,F,W);$++}if(!A(F))throw new Error('There may be a circular dependency in the equations');return F}function _(D,T){for(var F=Object.keys(D[T].components),Z=0;Z<F.length;Z++){var Q=F[Z],J=D.find(function($){return $.formed===Q});if(J)return!1}return!0}function A(D,T){return void 0===T?!D.some(function(F){return 0===F}):!T.some(function(F){return-1!==F&&!D[F]})}function K(D,T,F){var Z=D[F],Q={type:Z.type,formed:Z.formed,components:{}};I(D,Z,Q,1),T[F]=Q}function I(D,T,F,Z){for(var Q=F.components,J=T.components,$=Object.keys(J),W=function(ne){ee=$[ne];var ie=Z*J[ee];te=D.find((se)=>se.formed===$[ne]),te?I(D,te,F,ie):(Q[$[ne]]=Q[$[ne]]||0,Q[$[ne]]+=ie)},G=0;G<$.length;G++){var ee,te;W(G)}F.pK=F.pK||0,F.pK+=Z*T.pK}function M(D){return new S(D).toString('base64')}var R=function(){function D(T,F){var Z=[],Q=!0,J=!1,$;try{for(var G,W=T[Symbol.iterator]();!(Q=(G=W.next()).done)&&(Z.push(G.value),!(F&&Z.length===F));Q=!0);}catch(ee){J=!0,$=ee}finally{try{!Q&&W['return']&&W['return']()}finally{if(J)throw $}}return Z}return function(T,F){if(Array.isArray(T))return T;if(Symbol.iterator in Object(T))return D(T,F);throw new TypeError('Invalid attempt to destructure non-iterable instance')}}(),E=C(17);class P{constructor(D){D=D||[],this._normalized=!1,this._disabledKeys=new Set,this._equations=new Map;for(var T=0;T<D.length;T++)this.add(D[T])}[Symbol.iterator](){return this._equations.values()}clone(){var D=new P;D._normalized=this._normalized,D._disabledKeys=this._disabledKeys;var T=!0,F=!1,Z;try{for(var J,Q=this.entries()[Symbol.iterator]();!(T=(J=Q.next()).done);T=!0){var $=J.value,W=R($,2),G=W[0],ee=W[1];D._equations.set(G,ee.clone())}}catch(te){F=!0,Z=te}finally{try{!T&&Q.return&&Q.return()}finally{if(F)throw Z}}return D}add(D,T){var F=E.create(D);T=T||M(D.formed),this._equations.set(T,F),this._normalized=!1}has(D){if(D instanceof E)var T=M(D.formed);else T=D;return this._equations.has(T)}get species(){return this.getSpecies()}getSpecies(D){D=Object.assign({},D);var T=D.species,F=D.type,Z=D.includeDisabled,Q=new Set;if(T){var J=this.getSubset(T);return delete D.species,J.getSpecies(D)}var G,$=!0,W=!1;try{for(var te,ee=this.entries()[Symbol.iterator]();!($=(te=ee.next()).done);$=!0){var oe=te.value,ne=R(oe,2),ie=ne[0],se=ne[1];this._disabledKeys.has(ie)&&!Z||F&&F!==se.type||(Q.add(se.formed),Object.keys(se.components).forEach((re)=>Q.add(re)))}}catch(re){W=!0,G=re}finally{try{!$&&ee.return&&ee.return()}finally{if(W)throw G}}return Array.from(Q)}get components(){return this.getComponents()}getComponents(D){D=D||{};var T=D.species,F=D.type,Z=D.includeDisabled;if(!this.isNormalized())throw new Error('Cannot get components from non-normalized equation set');var Q=new Set,J=!0,$=!1,W;try{for(var ee,G=this.entries()[Symbol.iterator]();!(J=(ee=G.next()).done);J=!0){var te=ee.value,oe=R(te,2),ne=oe[0],ie=oe[1];this._disabledKeys.has(ne)&&!Z||F&&F!==ie.type||(T?-1<T.indexOf(ie.formed)?Object.keys(ie.components).forEach((se)=>Q.add(se)):Object.keys(ie.components).forEach((se)=>{-1<T.indexOf(se)&&Q.add(se)}):Object.keys(ie.components).forEach((se)=>Q.add(se)))}}catch(se){$=!0,W=se}finally{try{!J&&G.return&&G.return()}finally{if($)throw W}}return Array.from(Q)}disableEquation(D,T){D=T?M(D):D,this._disabledKeys.add(D)}enableEquation(D,T){D=T?M(D):D,this._disabledKeys.delete(D)}enableAllEquations(){this._disabledKeys.clear()}get size(){return this._equations.size}get(D,T){var F;return F=T?M(D):D,this._equations.get(F)}keys(){return this._equations.keys()}values(){return this._equations.values()}entries(){return this._equations.entries()}forEach(){return this._equations.forEach.apply(this._equations,arguments)}getNormalized(D){var $,T=Array(this._equations.size),F=Array(this._equations.size),Z=0,Q=!0,J=!1;try{for(var G,W=this.entries()[Symbol.iterator]();!(Q=(G=W.next()).done);Q=!0){var ee=G.value,te=R(ee,2),oe=te[0],ne=te[1];T[Z]=ne.withSolvent(D),F[Z]=oe,Z++}}catch(re){J=!0,$=re}finally{try{!Q&&W.return&&W.return()}finally{if(J)throw $}}T=O(T);for(var ie=new P,se=0;se<T.length;se++)ie.add(T[se],F[se]);return ie._normalized=!0,ie._disabledKeys=new Set(this._disabledKeys),ie}isNormalized(){return this._normalized}getEquations(D){return D=D||{},Array.from(this._equations).filter((T)=>D.includeDisabled||!this._disabledKeys.has(T[0])).map((T)=>{var F=T[1].toJSON();return this._disabledKeys.has(T[0])&&(F.disabled=!0),F})}getModel(D,T){if(!this.isNormalized())throw new Error('Cannot get model from un-normalized equation set');var F={};if(T)var Z=this;else Z=this.getSubset(Object.keys(D));var Q=Z.components,J=[...Z.keys()],$=[...Z.values()].filter((ie,se)=>!this._disabledKeys.has(J[se]));for(var W in Q.forEach((ie)=>F[ie]=0),D){var G=D[W]||0;if(-1!==Q.indexOf(W))F[W]+=G;else{var ee=$.find((ie)=>{return ie.formed===W});if(ee)for(var te=Object.keys(ee.components),oe=0;oe<te.length;oe++)F[te[oe]]+=ee.components[te[oe]]*G}}var ne={volume:1,components:Q.map((ie)=>{return{label:ie,total:F[ie]}}),formedSpecies:$.map((ie)=>{return{solid:'precipitation'===ie.type,label:ie.formed,beta:_Mathpow(10,ie.pK),components:Q.map((se)=>{return ie.components[se]||0})}})};return ne}getSubset(D){var T=new Set(D),F=new P,Z=!0,Q=0,J=($)=>{Q++,10==Q||this.forEach(function(W){if($.includes(W.formed)&&!F.has(W)){F.add(W),T.add(W.formed);var G=Object.keys(W.components);G.forEach((ee)=>T.add(ee)),J(G)}})};if(J(D),10==Q)throw new Error('You might have a circular dependency in your equations');for(Z=!0,Q=0;10>=Q&&Z;)Q++,Z=!1,this.forEach(function($){var W=Object.keys($.components).every((G)=>T.has(G));W&&!F.has($)&&(F.add($),T.add($.formed),Z=!0)});if(10==Q)throw new Error('You might have a circular dependency in your equations');return F._disabledKeys=new Set(this._disabledKeys),F._normalized=this._normalized,F}}o.exports=P}).call(u,C(3).Buffer)},function(o,u,C){'use strict';function O(P,D,T){return!D.some(function(F,Z){return T&&Z>=T?!1:_Mathabs(F)>=P})}function _(P,D,T){return!D.length||!D[0].some(function(F,Z){if(T[0][Z]===void 0)throw 2;return 0!==F&&_Mathabs(T[0][Z])>=P})}function A(P,D){return P.some(function(T,F){return D&&F>=D||0>=T})}function K(P,D){for(var T=[],F=P;F<=D;F++)T.push(F);return T}var I=C(12),M=C(5).matrix,R=C(23)('core:newton-rahpton'),E={tolerance:1e-15,solidTolerance:1e-5,maxIterations:99};o.exports=function(P,D,T,F,Z,Q,J,$){$=Object.assign({},E,$);var W=T.length,G=D.length;Z||(Z=Array(W).fill(0).map(()=>[])),Q||(Q=[]),J||(J=[]);var ee=Q.length;if(F.length!==W||P.length!==W||P[0].length!==G||J.length!==ee||Z.length!==W||Z[0]&&Z[0].length!==ee)throw new Error('Invalid arguments');if(P=new I(P),ee){Z=new I(Z);var te=new I([Q.map(Math.log2)]);J=new I([J])}for(var oe=0;oe<T.length;oe++)0===T[oe]&&(T[oe]=$.tolerance);for(F=new I([F]),oe=0;oe<$.maxIterations;oe++){var ne=[];if(ee){var ie=M.product(F.transpose().repeat(1,ee).pow(Z),0);ie.forEach((He,Oe)=>{He>Q[Oe]?ne.push(Oe):0<J[0][Oe]?ne.push(Oe):_Mathabs(He-Q[Oe])<$.tolerance&&ne.push(Oe)});var se=ie.slice();for(ye=0;ye<se.length;ye++)se[ye]=Math.log2(se[ye])}var re=ne.length;if(re)var ae=J.selection([0],ne),le=Z.selection(K(0,W-1),ne);var pe=W+re,ce=I.multiply([M.product(F.transpose().repeat(1,G).pow(P),0)],[D]),me=new I([M.sum(I.multiply(ce.repeat(W,1),P),1)]);ee&&me.add([M.sum(I.multiply(J.repeat(W,1),Z),1)]);var de=I.subtract([T],me);if(re){var ue=I.subtract(te,[se]).selection([0],ne),ge=I.subtract([Q],[ie]),fe=new I(1,pe);fe.setSubMatrix(de,0,0),fe.setSubMatrix(ue,0,W)}else fe=de;if(ee,O($.tolerance,de[0])&&_($.solidTolerance,J,ge))return R(`solution converged in ${oe} iterations`),ce.to1DArray().concat(J.to1DArray?J.to1DArray():J);for(var he=new I(pe,pe).fill(0),ye=0;ye<W;ye++)for(var be=ye;be<W;be++)for(var xe=0;xe<G;xe++)he[ye][be]+=P[be][xe]*P[ye][xe]*ce[0][xe],he[be][ye]=he[ye][be];for(ye=0;ye<W;ye++)for(be=0;be<re;be++){var ke=be+W;he[ye][ke]=le[ye][be],he[ke][ye]=le[ye][be]}var je=I.identity(pe).setSubMatrix(I.diag(F[0]),0,0),we=fe.mmul(he.inverse()).mmul(je),Ce=new I(1,pe);for(Ce.setSubMatrix(F,0,0),re&&Ce.setSubMatrix(ae,0,W),Ce.add(we);A(Ce[0])&&(we=we.multiply(0.5),Ce.subtract(we),!O($.tolerance,we[0])););for(ye=0;ye<F.columns;ye++)F.set(0,ye,Ce.get(0,ye));for(ye=0;ye<re;ye++){var Se=Ce.get(0,W+ye);0>Se?J.set(0,ne[ye],0):J.set(0,ne[ye],Se)}}return oe>=$.maxIterations?(R('did not converge'),null):ce.to1DArray().concat(J.to1DArray?J.to1DArray():J)}},function(o,u,C){'use strict';var S=C(6),O=C(14),_=C(15);S.Helper=O,S.Serie=_,o.exports=S},function(o,u){'use strict';u.logarithmic=function(S,O){if(O===void 0)return _Mathpow(S(),10);for(var _=Array(O),A=0;A<_.length;A++)_[A]=_Mathpow(S(),10);return _}},function(o,u){'use strict';function S(F){var Z=F.length;if(0<Z%4)throw new Error('Invalid string. Length must be a multiple of 4');return'='===F[Z-2]?2:'='===F[Z-1]?1:0}function A(F){return M[63&F>>18]+M[63&F>>12]+M[63&F>>6]+M[63&F]}function K(F,Z,Q){for(var J,$=[],W=Z;W<Q;W+=3)J=(F[W]<<16)+(F[W+1]<<8)+F[W+2],$.push(A(J));return $.join('')}u.byteLength=function(F){return 3*F.length/4-S(F)},u.toByteArray=function(F){var Z,Q,J,$,W,G,ee=F.length;W=S(F),G=new E(3*ee/4-W),J=0<W?ee-4:ee;var te=0;for(Z=0,Q=0;Z<J;Z+=4,Q+=3)$=R[F.charCodeAt(Z)]<<18|R[F.charCodeAt(Z+1)]<<12|R[F.charCodeAt(Z+2)]<<6|R[F.charCodeAt(Z+3)],G[te++]=255&$>>16,G[te++]=255&$>>8,G[te++]=255&$;return 2===W?($=R[F.charCodeAt(Z)]<<2|R[F.charCodeAt(Z+1)]>>4,G[te++]=255&$):1===W&&($=R[F.charCodeAt(Z)]<<10|R[F.charCodeAt(Z+1)]<<4|R[F.charCodeAt(Z+2)]>>2,G[te++]=255&$>>8,G[te++]=255&$),G},u.fromByteArray=function(F){for(var Z,Q=F.length,J=Q%3,$='',W=[],G=16383,ee=0,te=Q-J;ee<te;ee+=G)W.push(K(F,ee,ee+G>te?te:ee+G));return 1==J?(Z=F[Q-1],$+=M[Z>>2],$+=M[63&Z<<4],$+='=='):2==J&&(Z=(F[Q-2]<<8)+F[Q-1],$+=M[Z>>10],$+=M[63&Z>>4],$+=M[63&Z<<2],$+='='),W.push($),W.join('')};for(var M=[],R=[],E='undefined'==typeof Uint8Array?Array:Uint8Array,P='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',D=0,T=P.length;D<T;++D)M[D]=P[D],R[P.charCodeAt(D)]=D;R['-'.charCodeAt(0)]=62,R['_'.charCodeAt(0)]=63},function(o,u,C){(function(S){function I(){var R;try{R=u.storage.debug}catch(E){}return!R&&'undefined'!=typeof S&&'env'in S&&(R=S.env.DEBUG),R}u=o.exports=C(24),u.log=function(){return'object'==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},u.formatArgs=function(R){var E=this.useColors;if(R[0]=(E?'%c':'')+this.namespace+(E?' %c':' ')+R[0]+(E?'%c ':' ')+'+'+u.humanize(this.diff),!!E){var P='color: '+this.color;R.splice(1,0,P,'color: inherit');var D=0,T=0;R[0].replace(/%[a-zA-Z%]/g,function(F){'%%'===F||(D++,'%c'===F&&(T=D))}),R.splice(T,0,P)}},u.save=function(R){try{null==R?u.storage.removeItem('debug'):u.storage.debug=R}catch(E){}},u.load=I,u.useColors=function(){return'undefined'!=typeof window&&window&&'undefined'!=typeof window.process&&'renderer'===window.process.type||'undefined'!=typeof document&&document&&'WebkitAppearance'in document.documentElement.style||'undefined'!=typeof window&&window&&window.console&&(console.firebug||console.exception&&console.table)||'undefined'!=typeof navigator&&navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||'undefined'!=typeof navigator&&navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},u.storage='undefined'!=typeof chrome&&'undefined'!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(R){}}(),u.colors=['lightseagreen','forestgreen','goldenrod','dodgerblue','darkorchid','crimson'],u.formatters.j=function(R){try{return JSON.stringify(R)}catch(E){return'[UnexpectedJSONParseError]: '+E.message}},u.enable(I())}).call(u,C(47))},function(o,u,C){function S(R){var P,E=0;for(P in R)E=(E<<5)-E+R.charCodeAt(P),E|=0;return u.colors[_Mathabs(E)%u.colors.length]}function O(R){function E(){if(E.enabled){var P=E,D=+new Date,T=D-(M||D);P.diff=T,P.prev=M,P.curr=D,M=D;for(var F=Array(arguments.length),Z=0;Z<F.length;Z++)F[Z]=arguments[Z];F[0]=u.coerce(F[0]),'string'!=typeof F[0]&&F.unshift('%O');var Q=0;F[0]=F[0].replace(/%([a-zA-Z%])/g,function($,W){if('%%'===$)return $;Q++;var G=u.formatters[W];if('function'==typeof G){var ee=F[Q];$=G.call(P,ee),F.splice(Q,1),Q--}return $}),u.formatArgs.call(P,F);var J=E.log||u.log||console.log.bind(console);J.apply(P,F)}}return E.namespace=R,E.enabled=u.enabled(R),E.useColors=u.useColors(),E.color=S(R),'function'==typeof u.init&&u.init(E),E}u=o.exports=O.debug=O['default']=O,u.coerce=function(R){return R instanceof Error?R.stack||R.message:R},u.disable=function(){u.enable('')},u.enable=function(R){u.save(R),u.names=[],u.skips=[];for(var E=(R||'').split(/[\s,]+/),P=E.length,D=0;D<P;D++)E[D]&&(R=E[D].replace(/\*/g,'.*?'),'-'===R[0]?u.skips.push(new RegExp('^'+R.substr(1)+'$')):u.names.push(new RegExp('^'+R+'$')))},u.enabled=function(R){var E,P;for(E=0,P=u.skips.length;E<P;E++)if(u.skips[E].test(R))return!1;for(E=0,P=u.names.length;E<P;E++)if(u.names[E].test(R))return!0;return!1},u.humanize=C(46),u.names=[],u.skips=[],u.formatters={};var M},function(o,u,C){'use strict';(function(S){function _(M,R){if('function'!=typeof R)throw new TypeError('customizer is must be a Function');if('function'==typeof M){var E=M+'';return /^\s*function\s*\S*\([^\)]*\)\s*{\s*\[native code\]\s*}/.test(E)?M:new Function('return '+(E+''))()}var P=I.call(M);if('[object Array]'===P)return[];if('[object Object]'===P&&M.constructor===Object)return{};if('[object Date]'===P)return new Date(M.getTime());if('[object RegExp]'===P){var D=M+'',T=D.lastIndexOf('/');return new RegExp(D.slice(1,T),D.slice(T+1))}if((0,K.isBuffer)(M)){var F=new S(M.length);return M.copy(F),F}var Z=R(M);return void 0===Z?null:Z}function A(M){var R=typeof M;return null!==M&&'object'!=R&&'function'!=R?M:null}u.__esModule=!0,u.copyValue=u.copyCollection=u.copy=void 0;var K=C(8),I=Object.prototype.toString;u.copy=function(M,R){var E=A(M);return null===E?_(M,R):E},u.copyCollection=_,u.copyValue=A}).call(u,C(3).Buffer)},function(o,u,C){'use strict';function S(){}function _(I,M,R,E,P){if(null===I)return null;var D=(0,A.copyValue)(I);if(null!==D)return D;var T=(0,K.getKeys)(I).concat((0,K.getSymbols)(I)),F=void 0,Z,Q,J,$,W,G,ee;for(F=0,Z=T.length;F<Z;++F)Q=T[F],J=I[Q],$=(0,K.indexOf)(E,J),W=void 0,G=void 0,ee=void 0,-1===$?(W=(0,A.copy)(J,M),G=null===W?J:W,null!==J&&/^(?:function|object)$/.test(typeof J)&&(E.push(J),P.push(G))):ee=P[$],R[Q]=ee||_(J,M,G,E,P);return R}u.__esModule=!0;var A=C(25),K=C(8);u['default']=function(I){var M=1>=arguments.length||void 0===arguments[1]?S:arguments[1];if(null===I)return null;var R=(0,A.copyValue)(I);if(null!==R)return R;var E=(0,A.copyCollection)(I,M),P=null===E?I:E;return _(I,M,P,[I],[P])},o.exports=u['default']},function(o,u){u.read=function(C,S,O,_,A){var K,I,M=8*A-_-1,R=(1<<M)-1,E=R>>1,P=-7,D=O?A-1:0,T=O?-1:1,F=C[S+D];for(D+=T,K=F&(1<<-P)-1,F>>=-P,P+=M;0<P;K=256*K+C[S+D],D+=T,P-=8);for(I=K&(1<<-P)-1,K>>=-P,P+=_;0<P;I=256*I+C[S+D],D+=T,P-=8);if(0===K)K=1-E;else{if(K===R)return I?NaN:(F?-1:1)*Infinity;I+=_Mathpow(2,_),K-=E}return(F?-1:1)*I*_Mathpow(2,K-_)},u.write=function(C,S,O,_,A,K){var I,M,R,E=8*K-A-1,P=(1<<E)-1,D=P>>1,T=23===A?5.960464477539063e-8-6.617444900424222e-24:0,F=_?0:K-1,Z=_?1:-1,Q=0>S||0===S&&0>1/S?1:0;for(S=_Mathabs(S),isNaN(S)||S===Infinity?(M=isNaN(S)?1:0,I=P):(I=_Mathfloor(_Mathlog(S)/Math.LN2),1>S*(R=_Mathpow(2,-I))&&(I--,R*=2),S+=1<=I+D?T/R:T*_Mathpow(2,1-D),2<=S*R&&(I++,R/=2),I+D>=P?(M=0,I=P):1<=I+D?(M=(S*R-1)*_Mathpow(2,A),I+=D):(M=S*_Mathpow(2,D-1)*_Mathpow(2,A),I=0));8<=A;C[O+F]=255&M,F+=Z,M/=256,A-=8);for(I=I<<A|M,E+=A;0<E;C[O+F]=255&I,F+=Z,I/=256,E-=8);C[O+F-Z]|=128*Q}},function(o){var C={}.toString;o.exports=Array.isArray||function(S){return'[object Array]'==C.call(S)}},function(o,u,C){'use strict';function A(E){for(var P=Array(E[0].length),D=0;D<P.length;++D)P[D]=Array(E.length);for(D=0;D<E.length;++D)for(var T=0;T<E[0].length;++T)P[T][D]=E[D][T];return P}const R=C(5).array;o.exports={coordArrayToPoints:function(E,P){if(0!=E.length%P)throw new RangeError('Dimensions number must be accordance with the size of the array.');for(var Q,D=E.length/P,T=Array(D),F=0,Z=0;Z<E.length;Z+=P){Q=Array(P);for(var J=0;J<P;++J)Q[J]=E[Z+J];T[F]=Q,F++}return T},coordArrayToCoordMatrix:function(E,P){if(0!=E.length%P)throw new RangeError('Dimensions number must be accordance with the size of the array.');for(var D=Array(P),T=E.length/P,F=0;F<D.length;F++)D[F]=Array(T);for(F=0;F<E.length;F+=P)for(var Q,Z=0;Z<P;++Z)Q=_Mathfloor(F/P),D[Z][Q]=E[F+Z];return D},coordMatrixToCoordArray:function(E){for(var P=Array(E.length*E[0].length),D=0,T=0;T<E[0].length;++T)for(var F=0;F<E.length;++F)P[D]=E[F][T],++D;return P},coordMatrixToPoints:A,pointsToCoordArray:function(E){for(var P=Array(E.length*E[0].length),D=0,T=0;T<E.length;++T)for(var F=0;F<E[0].length;++F)P[D]=E[T][F],++D;return P},pointsToCoordMatrix:A,applyDotProduct:function(E,P){var D,T;E.length<=P.length?(T=E,D=P):(T=P,D=E);for(var J,F=D.length-T.length+1,Z=Array(F),Q=0;Q<F;++Q){J=0;for(var $=0;$<T.length;++$)J+=T[$]*D[Q+$];Z[Q]=J}return Z},scale:function(E,P){var D=P.inPlace?E:Array(E.length);const T=P.max,F=P.min;if('number'==typeof T){if('number'==typeof F)for(var Z=R.minMax(E),Q=(T-F)/(Z.max-Z.min),J=0;J<D.length;J++)D[J]=(E[J]-Z.min)*Q+F;else for(var $=R.max(E),Q=T/$,J=0;J<D.length;J++)D[J]=E[J]*Q;}else if('number'==typeof F)for(var $=R.min(E),Q=F/$,J=0;J<D.length;J++)D[J]=E[J]*Q;return D}}},function(o,u){'use strict';function O(K,I,M,R,E){function P(de,ue,ge,fe){return(fe-ue)/(ge-de)}var D=K.length,T=(R-M)/(E-1),Z=M-T/2,Q=Array(E),J=K[1]-K[0],$=K[K.length-1]-K[K.length-2],W=Z,G=Z+T,ee=Number.MIN_VALUE,te=0,oe=K[0]-J,ne=0,ie=0,se=0,re=0,ae=0,le=0,pe=0,ce=0;main:for(;;){for(;0<=oe-G;){var me=A(0,G-ee,se,te);if(le=ie+me,Q[ce]=(le-ae)/T,ce++,ce===E)break main;W=G,G+=T,ae=le}ee<=W&&W<=oe&&(me=A(0,W-ee,se,te),ae=ie+me),ie+=A(ee,oe,se,re),ee=oe,te=ne,pe<D?(oe=K[pe],ne=I[pe],pe++):pe===D&&(oe+=$,ne=0),se=P(ee,te,oe,ne),re=-se*ee+te}return Q}function _(K,I,M,R,E){var P=K.length,D=(R-M)/(E-1),F=K[K.length-1]-K[K.length-2],Z=M-D/2,Q=Array(E),J=Z,$=Z+D,W=-_NumberMAX_VALUE,G=0,ee=K[0],te=I[0],oe=0,ne=!0,ie=0,se=0,re=1,ae=0;main:for(;;){if(W>=ee)throw new Error('x must be an increasing serie');for(;0<W-$;){if(ne&&(se++,ne=!1),Q[ae]=0>=se?0:ie/se,ae++,ae===E)break main;J=$,$+=D,ie=0,se=0}W>J&&(ie+=G,se++),(W==-_NumberMAX_VALUE||1<oe)&&se--,W=ee,G=te,re<P?(ee=K[re],te=I[re],re++):(ee+=F,te=0,oe++)}return Q}function A(K,I,M,R){return 0.5*M*I*I+R*I-(0.5*M*K*K+R*K)}u.getEquallySpacedData=function(K,I,M){1<K.length&&K[0]>K[1]&&(K=K.slice().reverse(),I=I.slice().reverse());var R=K.length;if(R!==I.length)throw new RangeError('the x and y vector doesn\'t have the same size.');M===void 0&&(M={});var E=M.from===void 0?K[0]:M.from;if(isNaN(E)||!isFinite(E))throw new RangeError('\'From\' value must be a number');var P=M.to===void 0?K[K.length-1]:M.to;if(isNaN(P)||!isFinite(P))throw new RangeError('\'To\' value must be a number');var D=E>P;if(D){var T=E;E=P,P=T}var F=M.numberOfPoints===void 0?100:M.numberOfPoints;if(isNaN(F)||!isFinite(F))throw new RangeError('\'Number of points\' value must be a number');if(1>F)throw new RangeError('the number of point must be higher than 1');var Z='slot'===M.variant?'slot':'smooth',Q='slot'==Z?_(K,I,E,P,F):O(K,I,E,P,F);return D?Q.reverse():Q},u.integral=A},function(o,u,C){o.exports=u=C(29),u.getEquallySpacedData=C(30).getEquallySpacedData,u.SNV=C(32).SNV},function(o,u,C){'use strict';u.SNV=function(_){for(var A=O.mean(_),K=O.standardDeviation(_),I=_.slice(),M=0;M<_.length;M++)I[M]=(I[M]-A)/K;return I};var O=C(5).array},function(o,u,C){'use strict';function S(_){if(!(this instanceof S))return new S(_);if(_=O.checkMatrix(_),!_.isSymmetric())throw new Error('Matrix is not symmetric');var R,E,P,A=_,K=A.rows,I=new O(K,K),M=!0;for(E=0;E<K;E++){var D=I[E],T=0;for(P=0;P<E;P++){var F=I[P],Z=0;for(R=0;R<P;R++)Z+=F[R]*D[R];D[P]=Z=(A[E][P]-Z)/I[P][P],T+=Z*Z}for(T=A[E][E]-T,M&=0<T,I[E][E]=_Mathsqrt(_Mathmax(T,0)),P=E+1;P<K;P++)I[E][P]=0}if(!M)throw new Error('Matrix is not positive definite');this.L=I}var O=C(0).Matrix;S.prototype={get lowerTriangularMatrix(){return this.L},solve:function(_){_=O.checkMatrix(_);var A=this.L,K=A.rows;if(_.rows!==K)throw new Error('Matrix dimensions do not match');var R,E,P,I=_.columns,M=_.clone();for(P=0;P<K;P++)for(E=0;E<I;E++){for(R=0;R<P;R++)M[P][E]-=M[R][E]*A[P][R];M[P][E]/=A[P][P]}for(P=K-1;0<=P;P--)for(E=0;E<I;E++){for(R=P+1;R<K;R++)M[P][E]-=M[R][E]*A[R][P];M[P][E]/=A[P][P]}return M}},o.exports=S},function(o,u,C){'use strict';function S(T,F){if(F=Object.assign({},D,F),!(this instanceof S))return new S(T,F);if(T=M.checkMatrix(T),!T.isSquare())throw new Error('Matrix is not a square matrix');var G,ee,Z=T.columns,Q=P(Z,Z,0),J=Array(Z),$=Array(Z),W=T,te=!1;if(te=!!F.assumeSymmetric||T.isSymmetric(),te){for(G=0;G<Z;G++)for(ee=0;ee<Z;ee++)Q[G][ee]=W.get(G,ee);O(Z,$,J,Q),_(Z,$,J,Q)}else{var oe=P(Z,Z,0),ne=Array(Z);for(ee=0;ee<Z;ee++)for(G=0;G<Z;G++)oe[G][ee]=W.get(G,ee);A(Z,oe,ne,Q),K(Z,$,J,Q,oe)}this.n=Z,this.e=$,this.d=J,this.V=Q}function O(T,F,Z,Q){var J,$,W,G,ee,te,oe,ne;for(ee=0;ee<T;ee++)Z[ee]=Q[T-1][ee];for(G=T-1;0<G;G--){for(ne=0,W=0,te=0;te<G;te++)ne+=_Mathabs(Z[te]);if(0===ne)for(F[G]=Z[G-1],ee=0;ee<G;ee++)Z[ee]=Q[G-1][ee],Q[G][ee]=0,Q[ee][G]=0;else{for(te=0;te<G;te++)Z[te]/=ne,W+=Z[te]*Z[te];for(J=Z[G-1],$=_Mathsqrt(W),0<J&&($=-$),F[G]=ne*$,W-=J*$,Z[G-1]=J-$,ee=0;ee<G;ee++)F[ee]=0;for(ee=0;ee<G;ee++){for(J=Z[ee],Q[ee][G]=J,$=F[ee]+Q[ee][ee]*J,te=ee+1;te<=G-1;te++)$+=Q[te][ee]*Z[te],F[te]+=Q[te][ee]*J;F[ee]=$}for(J=0,ee=0;ee<G;ee++)F[ee]/=W,J+=F[ee]*Z[ee];for(oe=J/(W+W),ee=0;ee<G;ee++)F[ee]-=oe*Z[ee];for(ee=0;ee<G;ee++){for(J=Z[ee],$=F[ee],te=ee;te<=G-1;te++)Q[te][ee]-=J*F[te]+$*Z[te];Z[ee]=Q[G-1][ee],Q[G][ee]=0}}Z[G]=W}for(G=0;G<T-1;G++){if(Q[T-1][G]=Q[G][G],Q[G][G]=1,W=Z[G+1],0!==W){for(te=0;te<=G;te++)Z[te]=Q[te][G+1]/W;for(ee=0;ee<=G;ee++){for($=0,te=0;te<=G;te++)$+=Q[te][G+1]*Q[te][ee];for(te=0;te<=G;te++)Q[te][ee]-=$*Z[te]}}for(te=0;te<=G;te++)Q[te][G+1]=0}for(ee=0;ee<T;ee++)Z[ee]=Q[T-1][ee],Q[T-1][ee]=0;Q[T-1][T-1]=1,F[0]=0}function _(T,F,Z,Q){var J,$,W,G,ee,te,oe,ne,ie,se,re,ae,le,pe,ce,me,de;for(W=1;W<T;W++)F[W-1]=F[W];F[T-1]=0;var ue=0,ge=0,fe=2.220446049250313e-16;for(te=0;te<T;te++){for(ge=_Mathmax(ge,_Mathabs(Z[te])+_Mathabs(F[te])),oe=te;oe<T&&!(_Mathabs(F[oe])<=fe*ge);)oe++;if(oe>te){de=0;do{for(++de,J=Z[te],ne=(Z[te+1]-J)/(2*F[te]),ie=E(ne,1),0>ne&&(ie=-ie),Z[te]=F[te]/(ne+ie),Z[te+1]=F[te]*(ne+ie),se=Z[te+1],$=J-Z[te],W=te+2;W<T;W++)Z[W]-=$;for(ue+=$,ne=Z[oe],re=1,ae=re,le=re,pe=F[te+1],ce=0,me=0,W=oe-1;W>=te;W--)for(le=ae,ae=re,me=ce,J=re*F[W],$=re*ne,ie=E(ne,F[W]),F[W+1]=ce*ie,ce=F[W]/ie,re=ne/ie,ne=re*Z[W]-ce*J,Z[W+1]=$+ce*(re*J+ce*Z[W]),ee=0;ee<T;ee++)$=Q[ee][W+1],Q[ee][W+1]=ce*Q[ee][W]+re*$,Q[ee][W]=re*Q[ee][W]-ce*$;ne=-ce*me*le*pe*F[te]/se,F[te]=ce*ne,Z[te]=re*ne}while(_Mathabs(F[te])>fe*ge)}Z[te]+=ue,F[te]=0}for(W=0;W<T-1;W++){for(ee=W,ne=Z[W],G=W+1;G<T;G++)Z[G]<ne&&(ee=G,ne=Z[G]);if(ee!==W)for(Z[ee]=Z[W],Z[W]=ne,G=0;G<T;G++)ne=Q[G][W],Q[G][W]=Q[G][ee],Q[G][ee]=ne}}function A(T,F,Z,Q){var W,G,ee,te,oe,ne,ie,J=0,$=T-1;for(ne=J+1;ne<=$-1;ne++){for(ie=0,te=ne;te<=$;te++)ie+=_Mathabs(F[te][ne-1]);if(0!==ie){for(ee=0,te=$;te>=ne;te--)Z[te]=F[te][ne-1]/ie,ee+=Z[te]*Z[te];for(G=_Mathsqrt(ee),0<Z[ne]&&(G=-G),ee-=Z[ne]*G,Z[ne]-=G,oe=ne;oe<T;oe++){for(W=0,te=$;te>=ne;te--)W+=Z[te]*F[te][oe];for(W/=ee,te=ne;te<=$;te++)F[te][oe]-=W*Z[te]}for(te=0;te<=$;te++){for(W=0,oe=$;oe>=ne;oe--)W+=Z[oe]*F[te][oe];for(W/=ee,oe=ne;oe<=$;oe++)F[te][oe]-=W*Z[oe]}Z[ne]=ie*Z[ne],F[ne][ne-1]=ie*G}}for(te=0;te<T;te++)for(oe=0;oe<T;oe++)Q[te][oe]=te===oe?1:0;for(ne=$-1;ne>=J+1;ne--)if(0!==F[ne][ne-1]){for(te=ne+1;te<=$;te++)Z[te]=F[te][ne-1];for(oe=ne;oe<=$;oe++){for(G=0,te=ne;te<=$;te++)G+=Z[te]*Q[te][oe];for(G=G/Z[ne]/F[ne][ne-1],te=ne;te<=$;te++)Q[te][oe]+=G*Z[te]}}}function K(T,F,Z,Q,J){var pe,ce,me,de,ue,ge,fe,he,ye,be,xe,ke,je,we,Ce,$=T-1,W=0,G=T-1,ee=2.220446049250313e-16,te=0,oe=0,ne=0,ie=0,se=0,re=0,ae=0,le=0;for(pe=0;pe<T;pe++)for((pe<W||pe>G)&&(Z[pe]=J[pe][pe],F[pe]=0),ce=_Mathmax(pe-1,0);ce<T;ce++)oe+=_Mathabs(J[pe][ce]);for(;$>=W;){for(de=$;de>W&&(re=_Mathabs(J[de-1][de-1])+_Mathabs(J[de][de]),0===re&&(re=oe),!(_Mathabs(J[de][de-1])<ee*re));)de--;if(de===$)J[$][$]+=te,Z[$]=J[$][$],F[$]=0,$--,le=0;else if(de===$-1){if(fe=J[$][$-1]*J[$-1][$],ne=(J[$-1][$-1]-J[$][$])/2,ie=ne*ne+fe,ae=_Mathsqrt(_Mathabs(ie)),J[$][$]+=te,J[$-1][$-1]=J[$-1][$-1]+te,he=J[$][$],0<=ie){for(ae=0<=ne?ne+ae:ne-ae,Z[$-1]=he+ae,Z[$]=Z[$-1],0!==ae&&(Z[$]=he-fe/ae),F[$-1]=0,F[$]=0,he=J[$][$-1],re=_Mathabs(he)+_Mathabs(ae),ne=he/re,ie=ae/re,se=_Mathsqrt(ne*ne+ie*ie),ne/=se,ie/=se,ce=$-1;ce<T;ce++)ae=J[$-1][ce],J[$-1][ce]=ie*ae+ne*J[$][ce],J[$][ce]=ie*J[$][ce]-ne*ae;for(pe=0;pe<=$;pe++)ae=J[pe][$-1],J[pe][$-1]=ie*ae+ne*J[pe][$],J[pe][$]=ie*J[pe][$]-ne*ae;for(pe=W;pe<=G;pe++)ae=Q[pe][$-1],Q[pe][$-1]=ie*ae+ne*Q[pe][$],Q[pe][$]=ie*Q[pe][$]-ne*ae}else Z[$-1]=he+ne,Z[$]=he+ne,F[$-1]=ae,F[$]=-ae;$-=2,le=0}else{if(he=J[$][$],ye=0,fe=0,de<$&&(ye=J[$-1][$-1],fe=J[$][$-1]*J[$-1][$]),10==le){for(te+=he,pe=W;pe<=$;pe++)J[pe][pe]-=he;re=_Mathabs(J[$][$-1])+_Mathabs(J[$-1][$-2]),he=ye=0.75*re,fe=-0.4375*re*re}if(30==le&&(re=(ye-he)/2,re=re*re+fe,0<re)){for(re=_Mathsqrt(re),ye<he&&(re=-re),re=he-fe/((ye-he)/2+re),pe=W;pe<=$;pe++)J[pe][pe]-=re;te+=re,he=ye=fe=0.964}for(++le,ue=$-2;ue>=de&&(ae=J[ue][ue],se=he-ae,re=ye-ae,ne=(se*re-fe)/J[ue+1][ue]+J[ue][ue+1],ie=J[ue+1][ue+1]-ae-se-re,se=J[ue+2][ue+1],re=_Mathabs(ne)+_Mathabs(ie)+_Mathabs(se),ne/=re,ie/=re,se/=re,ue!==de)&&!(_Mathabs(J[ue][ue-1])*(_Mathabs(ie)+_Mathabs(se))<ee*(_Mathabs(ne)*(_Mathabs(J[ue-1][ue-1])+_Mathabs(ae)+_Mathabs(J[ue+1][ue+1]))));)ue--;for(pe=ue+2;pe<=$;pe++)J[pe][pe-2]=0,pe>ue+2&&(J[pe][pe-3]=0);for(me=ue;me<=$-1&&(we=me!==$-1,me!==ue&&(ne=J[me][me-1],ie=J[me+1][me-1],se=we?J[me+2][me-1]:0,he=_Mathabs(ne)+_Mathabs(ie)+_Mathabs(se),0!==he&&(ne/=he,ie/=he,se/=he)),0!==he);me++)if(re=_Mathsqrt(ne*ne+ie*ie+se*se),0>ne&&(re=-re),0!==re){for(me===ue?de!==ue&&(J[me][me-1]=-J[me][me-1]):J[me][me-1]=-re*he,ne+=re,he=ne/re,ye=ie/re,ae=se/re,ie/=ne,se/=ne,ce=me;ce<T;ce++)ne=J[me][ce]+ie*J[me+1][ce],we&&(ne+=se*J[me+2][ce],J[me+2][ce]=J[me+2][ce]-ne*ae),J[me][ce]-=ne*he,J[me+1][ce]=J[me+1][ce]-ne*ye;for(pe=0;pe<=_Mathmin($,me+3);pe++)ne=he*J[pe][me]+ye*J[pe][me+1],we&&(ne+=ae*J[pe][me+2],J[pe][me+2]=J[pe][me+2]-ne*se),J[pe][me]-=ne,J[pe][me+1]=J[pe][me+1]-ne*ie;for(pe=W;pe<=G;pe++)ne=he*Q[pe][me]+ye*Q[pe][me+1],we&&(ne+=ae*Q[pe][me+2],Q[pe][me+2]=Q[pe][me+2]-ne*se),Q[pe][me]-=ne,Q[pe][me+1]=Q[pe][me+1]-ne*ie}}}if(0!==oe){for($=T-1;0<=$;$--)if(ne=Z[$],ie=F[$],0===ie)for(de=$,J[$][$]=1,pe=$-1;0<=pe;pe--){for(fe=J[pe][pe]-ne,se=0,ce=de;ce<=$;ce++)se+=J[pe][ce]*J[ce][$];if(0>F[pe])ae=fe,re=se;else if(de=pe,0===F[pe]?J[pe][$]=0===fe?-se/(ee*oe):-se/fe:(he=J[pe][pe+1],ye=J[pe+1][pe],ie=(Z[pe]-ne)*(Z[pe]-ne)+F[pe]*F[pe],ge=(he*re-ae*se)/ie,J[pe][$]=ge,J[pe+1][$]=_Mathabs(he)>_Mathabs(ae)?(-se-fe*ge)/he:(-re-ye*ge)/ae),ge=_Mathabs(J[pe][$]),1<ee*ge*ge)for(ce=pe;ce<=$;ce++)J[ce][$]/=ge}else if(0>ie)for(de=$-1,_Mathabs(J[$][$-1])>_Mathabs(J[$-1][$])?(J[$-1][$-1]=ie/J[$][$-1],J[$-1][$]=-(J[$][$]-ne)/J[$][$-1]):(Ce=I(0,-J[$-1][$],J[$-1][$-1]-ne,ie),J[$-1][$-1]=Ce[0],J[$-1][$]=Ce[1]),J[$][$-1]=0,J[$][$]=1,pe=$-2;0<=pe;pe--){for(be=0,xe=0,ce=de;ce<=$;ce++)be+=J[pe][ce]*J[ce][$-1],xe+=J[pe][ce]*J[ce][$];if(fe=J[pe][pe]-ne,0>F[pe])ae=fe,se=be,re=xe;else if(de=pe,0===F[pe]?(Ce=I(-be,-xe,fe,ie),J[pe][$-1]=Ce[0],J[pe][$]=Ce[1]):(he=J[pe][pe+1],ye=J[pe+1][pe],ke=(Z[pe]-ne)*(Z[pe]-ne)+F[pe]*F[pe]-ie*ie,je=2*(Z[pe]-ne)*ie,0===ke&&0===je&&(ke=ee*oe*(_Mathabs(fe)+_Mathabs(ie)+_Mathabs(he)+_Mathabs(ye)+_Mathabs(ae))),Ce=I(he*se-ae*be+ie*xe,he*re-ae*xe-ie*be,ke,je),J[pe][$-1]=Ce[0],J[pe][$]=Ce[1],_Mathabs(he)>_Mathabs(ae)+_Mathabs(ie)?(J[pe+1][$-1]=(-be-fe*J[pe][$-1]+ie*J[pe][$])/he,J[pe+1][$]=(-xe-fe*J[pe][$]-ie*J[pe][$-1])/he):(Ce=I(-se-ye*J[pe][$-1],-re-ye*J[pe][$],ae,ie),J[pe+1][$-1]=Ce[0],J[pe+1][$]=Ce[1])),ge=_Mathmax(_Mathabs(J[pe][$-1]),_Mathabs(J[pe][$])),1<ee*ge*ge)for(ce=pe;ce<=$;ce++)J[ce][$-1]=J[ce][$-1]/ge,J[ce][$]/=ge}for(pe=0;pe<T;pe++)if(pe<W||pe>G)for(ce=pe;ce<T;ce++)Q[pe][ce]=J[pe][ce];for(ce=T-1;ce>=W;ce--)for(pe=W;pe<=G;pe++){for(ae=0,me=W;me<=_Mathmin(ce,G);me++)ae+=Q[pe][me]*J[me][ce];Q[pe][ce]=ae}}}function I(T,F,Z,Q){var J,$;return _Mathabs(Z)>_Mathabs(Q)?(J=Q/Z,$=Z+J*Q,[(T+J*F)/$,(F-J*T)/$]):(J=Z/Q,$=Q+J*Z,[(J*T+F)/$,(J*F-T)/$])}const M=C(0).Matrix,R=C(4),E=R.hypotenuse,P=R.getFilled2DArray,D={assumeSymmetric:!1};S.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return M.isMatrix(this.V)||(this.V=new M(this.V)),this.V},get diagonalMatrix(){var J,$,T=this.n,F=this.e,Z=this.d,Q=new M(T,T);for(J=0;J<T;J++){for($=0;$<T;$++)Q[J][$]=0;Q[J][J]=Z[J],0<F[J]?Q[J][J+1]=F[J]:0>F[J]&&(Q[J][J-1]=F[J])}return Q}},o.exports=S},function(o,u,C){'use strict';function S(A){if(!(this instanceof S))return new S(A);A=O.checkMatrix(A);var E,P,D,T,K=A.clone(),I=A.rows,M=A.columns,R=Array(M);for(D=0;D<M;D++){var F=0;for(E=D;E<I;E++)F=_(F,K[E][D]);if(0!==F){for(0>K[D][D]&&(F=-F),E=D;E<I;E++)K[E][D]/=F;for(K[D][D]+=1,P=D+1;P<M;P++){for(T=0,E=D;E<I;E++)T+=K[E][D]*K[E][P];for(T=-T/K[D][D],E=D;E<I;E++)K[E][P]+=T*K[E][D]}}R[D]=-F}this.QR=K,this.Rdiag=R}var O=C(0).Matrix,_=C(4).hypotenuse;S.prototype={solve:function(A){A=O.checkMatrix(A);var K=this.QR,I=K.rows;if(A.rows!==I)throw new Error('Matrix row dimensions must agree');if(!this.isFullRank())throw new Error('Matrix is rank deficient');var M=A.columns,R=A.clone(),E=K.columns,P,D,T,F;for(T=0;T<E;T++)for(D=0;D<M;D++){for(F=0,P=T;P<I;P++)F+=K[P][T]*R[P][D];for(F=-F/K[T][T],P=T;P<I;P++)R[P][D]+=F*K[P][T]}for(T=E-1;0<=T;T--){for(D=0;D<M;D++)R[T][D]/=this.Rdiag[T];for(P=0;P<T;P++)for(D=0;D<M;D++)R[P][D]-=R[T][D]*K[P][T]}return R.subMatrix(0,E-1,0,M-1)},isFullRank:function(){for(var A=this.QR.columns,K=0;K<A;K++)if(0===this.Rdiag[K])return!1;return!0},get upperTriangularMatrix(){var M,R,A=this.QR,K=A.columns,I=new O(K,K);for(M=0;M<K;M++)for(R=0;R<K;R++)I[M][R]=M<R?A[M][R]:M===R?this.Rdiag[M]:0;return I},get orthogonalMatrix(){var R,E,P,D,A=this.QR,K=A.rows,I=A.columns,M=new O(K,I);for(P=I-1;0<=P;P--){for(R=0;R<K;R++)M[R][P]=0;for(M[P][P]=1,E=P;E<I;E++)if(0!==A[P][P]){for(D=0,R=P;R<K;R++)D+=A[R][P]*M[R][E];for(D=-D/A[P][P],R=P;R<K;R++)M[R][E]+=D*A[R][P]}}return M}},o.exports=S},function(o,u,C){'use strict';function S(E){return E=_.checkMatrix(E),O(E,_.eye(E.rows))}function O(E,P){return E=_.checkMatrix(E),P=_.checkMatrix(P),E.isSquare()?new I(E).solve(P):new M(E).solve(P)}var _=C(0).Matrix,A=C(11),K=C(34),I=C(10),M=C(35),R=C(33);_.inverse=_.inv=S,_.prototype.inverse=_.prototype.inv=function(){return S(this)},_.solve=O,_.prototype.solve=function(E){return O(this,E)},o.exports={SingularValueDecomposition:A,SVD:A,EigenvalueDecomposition:K,EVD:K,LuDecomposition:I,LU:I,QrDecomposition:M,QR:M,CholeskyDecomposition:R,CHO:R,inverse:S,solve:O}},function(){'use strict';Symbol.species||(Symbol.species=Symbol.for('@@species'))},function(o,u,C){'use strict';var S=C(1);o.exports=class extends S{constructor(_,A){super(_,_.rows,1),this.column=A}set(_,A,K){return this.matrix.set(_,this.column,K),this}get(_){return this.matrix.get(_,this.column)}}},function(o,u,C){'use strict';var S=C(1);o.exports=class extends S{constructor(_){super(_,_.rows,_.columns)}set(_,A,K){return this.matrix.set(_,this.columns-A-1,K),this}get(_,A){return this.matrix.get(_,this.columns-A-1)}}},function(o,u,C){'use strict';var S=C(1);o.exports=class extends S{constructor(_){super(_,_.rows,_.columns)}set(_,A,K){return this.matrix.set(this.rows-_-1,A,K),this}get(_,A){return this.matrix.get(this.rows-_-1,A)}}},function(o,u,C){'use strict';var S=C(1);o.exports=class extends S{constructor(_,A){super(_,1,_.columns),this.row=A}set(_,A,K){return this.matrix.set(this.row,A,K),this}get(_,A){return this.matrix.get(this.row,A)}}},function(o,u,C){'use strict';var S=C(1),O=C(2);o.exports=class extends S{constructor(A,K,I){var M=O.checkIndices(A,K,I);super(A,M.row.length,M.column.length),this.rowIndices=M.row,this.columnIndices=M.column}set(A,K,I){return this.matrix.set(this.rowIndices[A],this.columnIndices[K],I),this}get(A,K){return this.matrix.get(this.rowIndices[A],this.columnIndices[K])}}},function(o,u,C){'use strict';var S=C(1),O=C(2);o.exports=class extends S{constructor(A,K,I,M,R){O.checkRange(A,K,I,M,R),super(A,I-K+1,R-M+1),this.startRow=K,this.startColumn=M}set(A,K,I){return this.matrix.set(this.startRow+A,this.startColumn+K,I),this}get(A,K){return this.matrix.get(this.startRow+A,this.startColumn+K)}}},function(o,u,C){'use strict';var S=C(1);o.exports=class extends S{constructor(_){super(_,_.columns,_.rows)}set(_,A,K){return this.matrix.set(A,_,K),this}get(_,A){return this.matrix.get(A,_)}}},function(o,u,C){'use strict';function S(_,A){return _-A}var O=C(13);u.max=function(A){for(var _=-Infinity,K=0;K<A.length;K++)for(var I=0;I<A[K].length;I++)A[K][I]>_&&(_=A[K][I]);return _},u.min=function(A){for(var _=Infinity,K=0;K<A.length;K++)for(var I=0;I<A[K].length;I++)A[K][I]<_&&(_=A[K][I]);return _},u.minMax=function(A){for(var K=Infinity,I=-Infinity,M=0;M<A.length;M++)for(var R=0;R<A[M].length;R++)A[M][R]<K&&(K=A[M][R]),A[M][R]>I&&(I=A[M][R]);return{min:K,max:I}},u.entropy=function(A,K){'undefined'==typeof K&&(K=0);for(var I=0,M=A.length,R=A[0].length,E=0;E<M;E++)for(var P=0;P<R;P++)I+=A[E][P]*_Mathlog(A[E][P]+K);return-I},u.mean=function(A,K){'undefined'==typeof K&&(K=0);var R,E,P,D,I=A.length,M=A[0].length;if(-1===K){for(R=[0],E=I*M,P=0;P<I;P++)for(D=0;D<M;D++)R[0]+=A[P][D];R[0]/=E}else if(0===K)for(R=Array(M),E=I,D=0;D<M;D++){for(R[D]=0,P=0;P<I;P++)R[D]+=A[P][D];R[D]/=E}else if(1===K)for(R=Array(I),E=M,D=0;D<I;D++){for(R[D]=0,P=0;P<M;P++)R[D]+=A[D][P];R[D]/=E}else throw new Error('Invalid dimension');return R},u.sum=function(A,K){'undefined'==typeof K&&(K=0);var R,E,P,I=A.length,M=A[0].length;if(-1===K)for(R=[0],E=0;E<I;E++)for(P=0;P<M;P++)R[0]+=A[E][P];else if(0===K)for(R=Array(M),P=0;P<M;P++)for(R[P]=0,E=0;E<I;E++)R[P]+=A[E][P];else if(1===K)for(R=Array(I),P=0;P<I;P++)for(R[P]=0,E=0;E<M;E++)R[P]+=A[P][E];else throw new Error('Invalid dimension');return R},u.product=function(A,K){'undefined'==typeof K&&(K=0);var R,E,P,I=A.length,M=A[0].length;if(-1===K)for(R=[1],E=0;E<I;E++)for(P=0;P<M;P++)R[0]*=A[E][P];else if(0===K)for(R=Array(M),P=0;P<M;P++)for(R[P]=1,E=0;E<I;E++)R[P]*=A[E][P];else if(1===K)for(R=Array(I),P=0;P<I;P++)for(R[P]=1,E=0;E<M;E++)R[P]*=A[P][E];else throw new Error('Invalid dimension');return R},u.standardDeviation=function(A,K,I){for(var M=u.variance(A,K,I),R=M.length,E=0;E<R;E++)M[E]=_Mathsqrt(M[E]);return M},u.variance=function(A,K,I){'undefined'==typeof I&&(I=!0),K=K||u.mean(A);var M=A.length;if(0===M)return[];for(var R=A[0].length,E=Array(R),P=0;P<R;P++){for(var D=0,T=0,F=0,Z=0;Z<M;Z++)F=A[Z][P]-K[P],D+=F,T+=F*F;E[P]=I?(T-D*D/M)/(M-1):(T-D*D/M)/M}return E},u.median=function(A){for(var E,K=A.length,I=A[0].length,M=Array(I),R=0;R<I;R++){E=Array(K);for(var P=0;P<K;P++)E[P]=A[P][R];E.sort(S);var D=E.length;M[R]=0==D%2?0.5*(E[D/2]+E[D/2-1]):E[_Mathfloor(D/2)]}return M},u.mode=function(A){var R,E,K=A.length,I=A[0].length,M=Array(I);for(R=0;R<I;R++){for(var P=Array(K),D=0;D<K;D++)P[D]=0;var T=Array(K),F=0;for(E=0;E<K;E++){var Z=T.indexOf(A[E][R]);0<=Z?P[Z]++:(T[F]=A[E][R],P[F]=1,F++)}var Q=0,J=0;for(E=0;E<F;E++)P[E]>Q&&(Q=P[E],J=E);M[R]=T[J]}return M},u.skewness=function(A,K){'undefined'==typeof K&&(K=!0);for(var I=u.mean(A),M=A.length,R=I.length,E=Array(R),P=0;P<R;P++){for(var Z,D=0,T=0,F=0;F<M;F++)Z=A[F][P]-I[P],D+=Z*Z,T+=Z*Z*Z;var Q=D/M,J=T/M,$=J/_Mathpow(Q,3/2);if(K){var W=_Mathsqrt(M*(M-1));E[P]=W/(M-2)*$}else E[P]=$}return E},u.kurtosis=function(A,K){'undefined'==typeof K&&(K=!0);for(var I=u.mean(A),M=A.length,R=A[0].length,E=Array(R),P=0;P<R;P++){for(var Z,D=0,T=0,F=0;F<M;F++)Z=A[F][P]-I[P],D+=Z*Z,T+=Z*Z*Z*Z;var Q=D/M,J=T/M;if(K){var $=D/(M-1),G=T/($*$);E[P]=M*(M+1)/((M-1)*(M-2)*(M-3))*G-3*((M-1)*(M-1)/((M-2)*(M-3)))}else E[P]=J/(Q*Q)-3}return E},u.standardError=function(A){for(var K=A.length,I=u.standardDeviation(A),M=I.length,R=Array(M),E=_Mathsqrt(K),P=0;P<M;P++)R[P]=I[P]/E;return R},u.covariance=function(A,K){return u.scatter(A,void 0,K)},u.scatter=function(A,K,I){'undefined'==typeof I&&(I=0),'undefined'==typeof K&&(0===I?K=A.length-1:1===I&&(K=A[0].length-1));var M=u.mean(A,I),R=A.length;if(0===R)return[[]];var P,D,T,F,Z,E=A[0].length;if(0===I){for(P=Array(E),D=0;D<E;D++)P[D]=Array(E);for(D=0;D<E;D++)for(T=D;T<E;T++){for(F=0,Z=0;Z<R;Z++)F+=(A[Z][T]-M[T])*(A[Z][D]-M[D]);F/=K,P[D][T]=F,P[T][D]=F}}else if(1===I){for(P=Array(R),D=0;D<R;D++)P[D]=Array(R);for(D=0;D<R;D++)for(T=D;T<R;T++){for(F=0,Z=0;Z<E;Z++)F+=(A[T][Z]-M[T])*(A[D][Z]-M[D]);F/=K,P[D][T]=F,P[T][D]=F}}else throw new Error('Invalid dimension');return P},u.correlation=function(A){var P,D,K=u.mean(A),I=u.standardDeviation(A,!0,K),M=u.zScores(A,K,I),R=A.length,E=A[0].length,T=Array(E);for(P=0;P<E;P++)T[P]=Array(E);for(P=0;P<E;P++)for(D=P;D<E;D++){for(var F=0,Z=0,Q=M.length;Z<Q;Z++)F+=M[Z][D]*M[Z][P];F/=R-1,T[P][D]=F,T[D][P]=F}return T},u.zScores=function(A,K,I){return K=K||u.mean(A),'undefined'==typeof I&&(I=u.standardDeviation(A,!0,K)),u.standardize(u.center(A,K,!1),I,!0)},u.center=function(A,K,I){K=K||u.mean(A);var E,P,D,M=A,R=A.length;if(!I)for(M=Array(R),E=0;E<R;E++)M[E]=Array(A[E].length);for(E=0;E<R;E++){var T=M[E];for(P=0,D=T.length;P<D;P++)T[P]=A[E][P]-K[P]}return M},u.standardize=function(A,K,I){'undefined'==typeof K&&(K=u.standardDeviation(A));var E,P,D,M=A,R=A.length;if(!I)for(M=Array(R),E=0;E<R;E++)M[E]=Array(A[E].length);for(E=0;E<R;E++){var T=M[E],F=A[E];for(P=0,D=T.length;P<D;P++)0===K[P]||isNaN(K[P])||(T[P]=F[P]/K[P])}return M},u.weightedVariance=function(A,K){var I=u.mean(A),M=A.length;if(0===M)return[];for(var R=A[0].length,E=Array(R),P=0;P<R;P++){for(var D=0,T=0,F=0,Z=0;Z<M;Z++){var Q=A[Z][P]-I[P],J=K[Z];D+=J*(Q*Q),F+=J,T+=J*J}E[P]=D*(F/(F*F-T))}return E},u.weightedMean=function(A,K,I){'undefined'==typeof I&&(I=0);var M=A.length;if(0===M)return[];var E,P,D,T,F,Z,R=A[0].length;if(0===I){for(E=Array(R),P=0;P<R;P++)E[P]=0;for(P=0;P<M;P++)for(Z=A[P],F=K[P],T=0;T<R;T++)E[T]+=Z[T]*F}else if(1===I){for(E=Array(M),P=0;P<M;P++)E[P]=0;for(T=0;T<M;T++)for(Z=A[T],F=K[T],P=0;P<R;P++)E[T]+=Z[P]*F}else throw new Error('Invalid dimension');var Q=O.sum(K);if(0!==Q)for(P=0,D=E.length;P<D;P++)E[P]/=Q;return E},u.weightedCovariance=function(A,K,I,M){M=M||0,I=I||u.weightedMean(A,K,M);for(var R=0,E=0,P=0,D=K.length;P<D;P++)R+=K[P],E+=K[P]*K[P];var T=R/(R*R-E);return u.weightedScatter(A,K,I,T,M)},u.weightedScatter=function(A,K,I,M,R){R=R||0,I=I||u.weightedMean(A,K,R),'undefined'==typeof M&&(M=1);var E=A.length;if(0===E)return[[]];var D,T,F,Z,Q,P=A[0].length;if(0===R){for(D=Array(P),T=0;T<P;T++)D[T]=Array(P);for(T=0;T<P;T++)for(F=T;F<P;F++){for(Q=0,Z=0;Z<E;Z++)Q+=K[Z]*(A[Z][F]-I[F])*(A[Z][T]-I[T]);D[T][F]=Q*M,D[F][T]=Q*M}}else if(1===R){for(D=Array(E),T=0;T<E;T++)D[T]=Array(E);for(T=0;T<E;T++)for(F=T;F<E;F++){for(Q=0,Z=0;Z<P;Z++)Q+=K[Z]*(A[F][Z]-I[F])*(A[T][Z]-I[T]);D[T][F]=Q*M,D[F][T]=Q*M}}else throw new Error('Invalid dimension');return D}},function(o){function C(E){if(E+='',!(1e4<E.length)){var P=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(E);if(P){var D=parseFloat(P[1]),T=(P[2]||'ms').toLowerCase();return'years'===T||'year'===T||'yrs'===T||'yr'===T||'y'===T?D*R:'days'===T||'day'===T||'d'===T?D*M:'hours'===T||'hour'===T||'hrs'===T||'hr'===T||'h'===T?D*I:'minutes'===T||'minute'===T||'mins'===T||'min'===T||'m'===T?D*K:'seconds'===T||'second'===T||'secs'===T||'sec'===T||'s'===T?D*A:'milliseconds'===T||'millisecond'===T||'msecs'===T||'msec'===T||'ms'===T?D:void 0}}}function S(E){return E>=M?_Mathround(E/M)+'d':E>=I?_Mathround(E/I)+'h':E>=K?_Mathround(E/K)+'m':E>=A?_Mathround(E/A)+'s':E+'ms'}function O(E){return _(E,M,'day')||_(E,I,'hour')||_(E,K,'minute')||_(E,A,'second')||E+' ms'}function _(E,P,D){return E<P?void 0:E<1.5*P?_Mathfloor(E/P)+' '+D:_Mathceil(E/P)+' '+D+'s'}var A=1e3,K=60*A,I=60*K,M=24*I,R=365.25*M;o.exports=function(E,P){P=P||{};var D=typeof E;if('string'==D&&0<E.length)return C(E);if('number'==D&&!1===isNaN(E))return P.long?O(E):S(E);throw new Error('val is not a non-empty string or a valid number. val='+JSON.stringify(E))}},function(o){function C(){throw new Error('setTimeout has not been defined')}function S(){throw new Error('clearTimeout has not been defined')}function O(Q){if(E===setTimeout)return setTimeout(Q,0);if((E===C||!E)&&setTimeout)return E=setTimeout,setTimeout(Q,0);try{return E(Q,0)}catch(J){try{return E.call(null,Q,0)}catch($){return E.call(this,Q,0)}}}function _(Q){if(P===clearTimeout)return clearTimeout(Q);if((P===S||!P)&&clearTimeout)return P=clearTimeout,clearTimeout(Q);try{return P(Q)}catch(J){try{return P.call(null,Q)}catch($){return P.call(this,Q)}}}function A(){T&&F&&(T=!1,F.length?D=F.concat(D):Z=-1,D.length&&K())}function K(){if(!T){var Q=O(A);T=!0;for(var J=D.length;J;){for(F=D,D=[];++Z<J;)F&&F[Z].run();Z=-1,J=D.length}F=null,T=!1,_(Q)}}function I(Q,J){this.fun=Q,this.array=J}function M(){}var R=o.exports={},E,P;(function(){try{E='function'==typeof setTimeout?setTimeout:C}catch(Q){E=C}try{P='function'==typeof clearTimeout?clearTimeout:S}catch(Q){P=S}})();var D=[],T=!1,F,Z=-1;R.nextTick=function(Q){var J=Array(arguments.length-1);if(1<arguments.length)for(var $=1;$<arguments.length;$++)J[$-1]=arguments[$];D.push(new I(Q,J)),1!==D.length||T||O(K)},I.prototype.run=function(){this.fun.apply(null,this.array)},R.title='browser',R.browser=!0,R.env={},R.argv=[],R.version='',R.versions={},R.on=M,R.addListener=M,R.once=M,R.off=M,R.removeListener=M,R.removeAllListeners=M,R.emit=M,R.binding=function(){throw new Error('process.binding is not supported')},R.cwd=function(){return'/'},R.chdir=function(){throw new Error('process.chdir is not supported')},R.umask=function(){return 0}},function(o){var C=function(){return this}();try{C=C||Function('return this')()||(1,eval)('this')}catch(S){'object'==typeof window&&(C=window)}o.exports=C}])});
//# sourceMappingURL=chem-equilibrium.min.js.map